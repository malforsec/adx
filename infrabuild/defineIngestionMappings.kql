//Create ingestion mapping for tables

//to get the mapping from existing table:
    // .show table event ingestion json mappings
    //| extend formatted_mapping = strcat("'",replace_string(Mapping, "'", "\\'"),"'")
    //| project formatted_mapping

//sysmon json mapping
.create table sysmon ingestion json mapping "sysmonJsonMapping" '[{"column":"_timestamp","path":"$[\'@timestamp\']","datatype":"","transform":null},{"column":"host_name","path":"$[\'host\'][\'name\']","datatype":"","transform":null},{"column":"host_id","path":"$[\'host\'][\'id\']","datatype":"","transform":null},{"column":"host_mac","path":"$[\'host\'][\'mac\']","datatype":"","transform":null},{"column":"host_ip","path":"$[\'host\'][\'ip\']","datatype":"","transform":null},{"column":"host_hostname","path":"$[\'host\'][\'hostname\']","datatype":"","transform":null},{"column":"host_architecture","path":"$[\'host\'][\'architecture\']","datatype":"","transform":null},{"column":"host_os_kernel","path":"$[\'host\'][\'os\'][\'kernel\']","datatype":"","transform":null},{"column":"host_os_build","path":"$[\'host\'][\'os\'][\'build\']","datatype":"","transform":null},{"column":"host_os_type","path":"$[\'host\'][\'os\'][\'type\']","datatype":"","transform":null},{"column":"host_os_platform","path":"$[\'host\'][\'os\'][\'platform\']","datatype":"","transform":null},{"column":"host_os_version","path":"$[\'host\'][\'os\'][\'version\']","datatype":"","transform":null},{"column":"host_os_family","path":"$[\'host\'][\'os\'][\'family\']","datatype":"","transform":null},{"column":"host_os_name","path":"$[\'host\'][\'os\'][\'name\']","datatype":"","transform":null},{"column":"rule_name","path":"$[\'rule\'][\'name\']","datatype":"","transform":null},{"column":"registry_key","path":"$[\'registry\'][\'key\']","datatype":"","transform":null},{"column":"registry_value_0","path":"$[\'registry\'][\'value\'][\'0\']","datatype":"","transform":null},{"column":"registry_value_1","path":"$[\'registry\'][\'value\'][\'1\']","datatype":"","transform":null},{"column":"registry_path","path":"$[\'registry\'][\'path\']","datatype":"","transform":null},{"column":"registry_hive","path":"$[\'registry\'][\'hive\']","datatype":"","transform":null},{"column":"registry_data_strings","path":"$[\'registry\'][\'data\'][\'strings\']","datatype":"","transform":null},{"column":"registry_data_type","path":"$[\'registry\'][\'data\'][\'type\']","datatype":"","transform":null},{"column":"agent_id","path":"$[\'agent\'][\'id\']","datatype":"","transform":null},{"column":"agent_name","path":"$[\'agent\'][\'name\']","datatype":"","transform":null},{"column":"agent_type","path":"$[\'agent\'][\'type\']","datatype":"","transform":null},{"column":"agent_version","path":"$[\'agent\'][\'version\']","datatype":"","transform":null},{"column":"agent_ephemeral_id","path":"$[\'agent\'][\'ephemeral_id\']","datatype":"","transform":null},{"column":"agent_hostname","path":"$[\'agent\'][\'hostname\']","datatype":"","transform":null},{"column":"event_type","path":"$[\'event\'][\'type\']","datatype":"","transform":null},{"column":"event_module","path":"$[\'event\'][\'module\']","datatype":"","transform":null},{"column":"event_category","path":"$[\'event\'][\'category\']","datatype":"","transform":null},{"column":"event_kind","path":"$[\'event\'][\'kind\']","datatype":"","transform":null},{"column":"event_created","path":"$[\'event\'][\'created\']","datatype":"","transform":null},{"column":"event_provider","path":"$[\'event\'][\'provider\']","datatype":"","transform":null},{"column":"event_code","path":"$[\'event\'][\'code\']","datatype":"","transform":null},{"column":"event_action","path":"$[\'event\'][\'action\']","datatype":"","transform":null},{"column":"log_level","path":"$[\'log\'][\'level\']","datatype":"","transform":null},{"column":"message","path":"$[\'message\']","datatype":"","transform":null},{"column":"winlog_process_pid","path":"$[\'winlog\'][\'process\'][\'pid\']","datatype":"","transform":null},{"column":"winlog_process_thread","path":"$[\'winlog\'][\'process\'][\'thread\']","datatype":"","transform":null},{"column":"winlog_user_name","path":"$[\'winlog\'][\'user\'][\'name\']","datatype":"","transform":null},{"column":"winlog_user_identifier","path":"$[\'winlog\'][\'user\'][\'identifier\']","datatype":"","transform":null},{"column":"winlog_user_domain","path":"$[\'winlog\'][\'user\'][\'domain\']","datatype":"","transform":null},{"column":"winlog_user_type","path":"$[\'winlog\'][\'user\'][\'type\']","datatype":"","transform":null},{"column":"winlog_provider_name","path":"$[\'winlog\'][\'provider_name\']","datatype":"","transform":null},{"column":"winlog_task","path":"$[\'winlog\'][\'task\']","datatype":"","transform":null},{"column":"winlog_channel","path":"$[\'winlog\'][\'channel\']","datatype":"","transform":null},{"column":"winlog_record_id","path":"$[\'winlog\'][\'record_id\']","datatype":"","transform":null},{"column":"winlog_computer_name","path":"$[\'winlog\'][\'computer_name\']","datatype":"","transform":null},{"column":"winlog_event_data_EventType","path":"$[\'winlog\'][\'event_data\'][\'EventType\']","datatype":"","transform":null},{"column":"winlog_event_data_TargetObject","path":"$[\'winlog\'][\'event_data\'][\'TargetObject\']","datatype":"","transform":null},{"column":"winlog_event_data_User","path":"$[\'winlog\'][\'event_data\'][\'User\']","datatype":"","transform":null},{"column":"winlog_event_data_CreationUtcTime","path":"$[\'winlog\'][\'event_data\'][\'CreationUtcTime\']","datatype":"","transform":null},{"column":"winlog_event_data_Details","path":"$[\'winlog\'][\'event_data\'][\'Details\']","datatype":"","transform":null},{"column":"winlog_event_data_Product","path":"$[\'winlog\'][\'event_data\'][\'Product\']","datatype":"","transform":null},{"column":"winlog_event_data_Company","path":"$[\'winlog\'][\'event_data\'][\'Company\']","datatype":"","transform":null},{"column":"winlog_event_data_Description","path":"$[\'winlog\'][\'event_data\'][\'Description\']","datatype":"","transform":null},{"column":"winlog_event_data_Signed","path":"$[\'winlog\'][\'event_data\'][\'Signed\']","datatype":"","transform":null},{"column":"winlog_event_data_Signature","path":"$[\'winlog\'][\'event_data\'][\'Signature\']","datatype":"","transform":null},{"column":"winlog_event_data_SignatureStatus","path":"$[\'winlog\'][\'event_data\'][\'SignatureStatus\']","datatype":"","transform":null},{"column":"winlog_event_data_FileVersion","path":"$[\'winlog\'][\'event_data\'][\'FileVersion\']","datatype":"","transform":null},{"column":"winlog_version","path":"$[\'winlog\'][\'version\']","datatype":"","transform":null},{"column":"winlog_api","path":"$[\'winlog\'][\'api\']","datatype":"","transform":null},{"column":"winlog_opcode","path":"$[\'winlog\'][\'opcode\']","datatype":"","transform":null},{"column":"winlog_provider_guid","path":"$[\'winlog\'][\'provider_guid\']","datatype":"","transform":null},{"column":"winlog_event_id","path":"$[\'winlog\'][\'event_id\']","datatype":"","transform":null},{"column":"process_pid","path":"$[\'process\'][\'pid\']","datatype":"","transform":null},{"column":"process_entity_id","path":"$[\'process\'][\'entity_id\']","datatype":"","transform":null},{"column":"process_executable","path":"$[\'process\'][\'executable\']","datatype":"","transform":null},{"column":"process_name","path":"$[\'process\'][\'name\']","datatype":"","transform":null},{"column":"ecs_version","path":"$[\'ecs\'][\'version\']","datatype":"","transform":null},{"column":"file_pe_imphash","path":"$[\'file\'][\'pe\'][\'imphash\']","datatype":"","transform":null},{"column":"file_pe_description","path":"$[\'file\'][\'pe\'][\'description\']","datatype":"","transform":null},{"column":"file_pe_original_file_name","path":"$[\'file\'][\'pe\'][\'original_file_name\']","datatype":"","transform":null},{"column":"file_pe_product","path":"$[\'file\'][\'pe\'][\'product\']","datatype":"","transform":null},{"column":"file_pe_company","path":"$[\'file\'][\'pe\'][\'company\']","datatype":"","transform":null},{"column":"file_pe_file_version","path":"$[\'file\'][\'pe\'][\'file_version\']","datatype":"","transform":null},{"column":"file_name","path":"$[\'file\'][\'name\']","datatype":"","transform":null},{"column":"file_path","path":"$[\'file\'][\'path\']","datatype":"","transform":null},{"column":"file_directory","path":"$[\'file\'][\'directory\']","datatype":"","transform":null},{"column":"file_extension","path":"$[\'file\'][\'extension\']","datatype":"","transform":null},{"column":"file_code_signature_subject_name","path":"$[\'file\'][\'code_signature\'][\'subject_name\']","datatype":"","transform":null},{"column":"file_code_signature_status","path":"$[\'file\'][\'code_signature\'][\'status\']","datatype":"","transform":null},{"column":"file_code_signature_signed","path":"$[\'file\'][\'code_signature\'][\'signed\']","datatype":"","transform":null},{"column":"file_code_signature_valid","path":"$[\'file\'][\'code_signature\'][\'valid\']","datatype":"","transform":null},{"column":"file_hash_md5","path":"$[\'file\'][\'hash\'][\'md5\']","datatype":"","transform":null},{"column":"file_hash_sha256","path":"$[\'file\'][\'hash\'][\'sha256\']","datatype":"","transform":null},{"column":"file_hash_sha1","path":"$[\'file\'][\'hash\'][\'sha1\']","datatype":"","transform":null},{"column":"hash_sha1","path":"$[\'hash\'][\'sha1\']","datatype":"","transform":null},{"column":"hash_md5","path":"$[\'hash\'][\'md5\']","datatype":"","transform":null},{"column":"hash_sha256","path":"$[\'hash\'][\'sha256\']","datatype":"","transform":null},{"column":"hash_imphash","path":"$[\'hash\'][\'imphash\']","datatype":"","transform":null},{"column":"related_hash","path":"$[\'related\'][\'hash\']","datatype":"","transform":null}]'

//suricataeve json mapping
.create table suricataeve ingestion json mapping "suricataeveJsonMapping" '[{"column":"agent_ephemeral_id","path":"$[\'agent\'][\'ephemeral_id\']","datatype":"","transform":null},{"column":"agent_hostname","path":"$[\'agent\'][\'hostname\']","datatype":"","transform":null},{"column":"agent_name","path":"$[\'agent\'][\'name\']","datatype":"","transform":null},{"column":"agent_id","path":"$[\'agent\'][\'id\']","datatype":"","transform":null},{"column":"agent_type","path":"$[\'agent\'][\'type\']","datatype":"","transform":null},{"column":"agent_version","path":"$[\'agent\'][\'version\']","datatype":"","transform":null},{"column":"log_file","path":"$[\'log\'][\'file\']","datatype":"","transform":null},{"column":"log_offset","path":"$[\'log\'][\'offset\']","datatype":"","transform":null},{"column":"destination_geo","path":"$[\'destination\'][\'geo\']","datatype":"","transform":null},{"column":"destination_as","path":"$[\'destination\'][\'as\']","datatype":"","transform":null},{"column":"destination_address","path":"$[\'destination\'][\'address\']","datatype":"","transform":null},{"column":"destination_packets","path":"$[\'destination\'][\'packets\']","datatype":"","transform":null},{"column":"destination_port","path":"$[\'destination\'][\'port\']","datatype":"","transform":null},{"column":"destination_ip","path":"$[\'destination\'][\'ip\']","datatype":"","transform":null},{"column":"destination_bytes","path":"$[\'destination\'][\'bytes\']","datatype":"","transform":null},{"column":"destination_domain","path":"$[\'destination\'][\'domain\']","datatype":"","transform":null},{"column":"rule_name","path":"$[\'rule\'][\'name\']","datatype":"","transform":null},{"column":"rule_id","path":"$[\'rule\'][\'id\']","datatype":"","transform":null},{"column":"rule_category","path":"$[\'rule\'][\'category\']","datatype":"","transform":null},{"column":"source_address","path":"$[\'source\'][\'address\']","datatype":"","transform":null},{"column":"source_packets","path":"$[\'source\'][\'packets\']","datatype":"","transform":null},{"column":"source_port","path":"$[\'source\'][\'port\']","datatype":"","transform":null},{"column":"source_ip","path":"$[\'source\'][\'ip\']","datatype":"","transform":null},{"column":"source_bytes","path":"$[\'source\'][\'bytes\']","datatype":"","transform":null},{"column":"network_packets","path":"$[\'network\'][\'packets\']","datatype":"","transform":null},{"column":"network_community_id","path":"$[\'network\'][\'community_id\']","datatype":"","transform":null},{"column":"network_protocol","path":"$[\'network\'][\'protocol\']","datatype":"","transform":null},{"column":"network_bytes","path":"$[\'network\'][\'bytes\']","datatype":"","transform":null},{"column":"network_direction","path":"$[\'network\'][\'direction\']","datatype":"","transform":null},{"column":"network_transport","path":"$[\'network\'][\'transport\']","datatype":"","transform":null},{"column":"ecs_version","path":"$[\'ecs\'][\'version\']","datatype":"","transform":null},{"column":"related_ip","path":"$[\'related\'][\'ip\']","datatype":"","transform":null},{"column":"related_hosts","path":"$[\'related\'][\'hosts\']","datatype":"","transform":null},{"column":"host_ip","path":"$[\'host\'][\'ip\']","datatype":"","transform":null},{"column":"host_hostname","path":"$[\'host\'][\'hostname\']","datatype":"","transform":null},{"column":"host_os","path":"$[\'host\'][\'os\']","datatype":"","transform":null},{"column":"host_architecture","path":"$[\'host\'][\'architecture\']","datatype":"","transform":null},{"column":"host_containerized","path":"$[\'host\'][\'containerized\']","datatype":"","transform":null},{"column":"host_name","path":"$[\'host\'][\'name\']","datatype":"","transform":null},{"column":"host_mac","path":"$[\'host\'][\'mac\']","datatype":"","transform":null},{"column":"host_id","path":"$[\'host\'][\'id\']","datatype":"","transform":null},{"column":"event_original","path":"$[\'event\'][\'original\']","datatype":"","transform":null},{"column":"event_severity","path":"$[\'event\'][\'severity\']","datatype":"","transform":null},{"column":"event_ingested","path":"$[\'event\'][\'ingested\']","datatype":"","transform":null},{"column":"event_dataset","path":"$[\'event\'][\'dataset\']","datatype":"","transform":null},{"column":"event_kind","path":"$[\'event\'][\'kind\']","datatype":"","transform":null},{"column":"event_created","path":"$[\'event\'][\'created\']","datatype":"","transform":null},{"column":"event_module","path":"$[\'event\'][\'module\']","datatype":"","transform":null},{"column":"event_start","path":"$[\'event\'][\'start\']","datatype":"","transform":null},{"column":"event_category","path":"$[\'event\'][\'category\']","datatype":"","transform":null},{"column":"event_type","path":"$[\'event\'][\'type\']","datatype":"","transform":null},{"column":"fileset_name","path":"$[\'fileset\'][\'name\']","datatype":"","transform":null},{"column":"message","path":"$[\'message\']","datatype":"","transform":null},{"column":"url_path","path":"$[\'url\'][\'path\']","datatype":"","transform":null},{"column":"url_original","path":"$[\'url\'][\'original\']","datatype":"","transform":null},{"column":"url_domain","path":"$[\'url\'][\'domain\']","datatype":"","transform":null},{"column":"tags","path":"$[\'tags\']","datatype":"","transform":null},{"column":"input_type","path":"$[\'input\'][\'type\']","datatype":"","transform":null},{"column":"_timestamp","path":"$[\'@timestamp\']","datatype":"","transform":null},{"column":"service_type","path":"$[\'service\'][\'type\']","datatype":"","transform":null},{"column":"http_request","path":"$[\'http\'][\'request\']","datatype":"","transform":null},{"column":"http_response","path":"$[\'http\'][\'response\']","datatype":"","transform":null},{"column":"suricata_eve","path":"$[\'suricata\'][\'eve\']","datatype":"","transform":null}]'

//winevent powershell events json mapping
.create table winevent ingestion json mapping "wineventPowershellJsonMapping" '[{"column":"_timestamp","path":"$[\'@timestamp\']","datatype":"","transform":null},{"column":"log_level","path":"$[\'log\'][\'level\']","datatype":"","transform":null},{"column":"message","path":"$[\'message\']","datatype":"","transform":null},{"column":"related_user","path":"$[\'related\'][\'user\']","datatype":"","transform":null},{"column":"agent_name","path":"$[\'agent\'][\'name\']","datatype":"","transform":null},{"column":"agent_type","path":"$[\'agent\'][\'type\']","datatype":"","transform":null},{"column":"agent_version","path":"$[\'agent\'][\'version\']","datatype":"","transform":null},{"column":"agent_ephemeral_id","path":"$[\'agent\'][\'ephemeral_id\']","datatype":"","transform":null},{"column":"agent_hostname","path":"$[\'agent\'][\'hostname\']","datatype":"","transform":null},{"column":"agent_id","path":"$[\'agent\'][\'id\']","datatype":"","transform":null},{"column":"host_os","path":"$[\'host\'][\'os\']","datatype":"","transform":null},{"column":"host_mac","path":"$[\'host\'][\'mac\']","datatype":"","transform":null},{"column":"host_id","path":"$[\'host\'][\'id\']","datatype":"","transform":null},{"column":"host_hostname","path":"$[\'host\'][\'hostname\']","datatype":"","transform":null},{"column":"host_ip","path":"$[\'host\'][\'ip\']","datatype":"","transform":null},{"column":"host_name","path":"$[\'host\'][\'name\']","datatype":"","transform":null},{"column":"host_architecture","path":"$[\'host\'][\'architecture\']","datatype":"","transform":null},{"column":"winlog_version","path":"$[\'winlog\'][\'version\']","datatype":"","transform":null},{"column":"winlog_api","path":"$[\'winlog\'][\'api\']","datatype":"","transform":null},{"column":"winlog_opcode","path":"$[\'winlog\'][\'opcode\']","datatype":"","transform":null},{"column":"winlog_provider_guid","path":"$[\'winlog\'][\'provider_guid\']","datatype":"","transform":null},{"column":"winlog_task","path":"$[\'winlog\'][\'task\']","datatype":"","transform":null},{"column":"winlog_activity_id","path":"$[\'winlog\'][\'activity_id\']","datatype":"","transform":null},{"column":"winlog_record_id","path":"$[\'winlog\'][\'record_id\']","datatype":"","transform":null},{"column":"winlog_process","path":"$[\'winlog\'][\'process\']","datatype":"","transform":null},{"column":"winlog_provider_name","path":"$[\'winlog\'][\'provider_name\']","datatype":"","transform":null},{"column":"winlog_computer_name","path":"$[\'winlog\'][\'computer_name\']","datatype":"","transform":null},{"column":"winlog_event_id","path":"$[\'winlog\'][\'event_id\']","datatype":"","transform":null},{"column":"winlog_channel","path":"$[\'winlog\'][\'channel\']","datatype":"","transform":null},{"column":"event_provider","path":"$[\'event\'][\'provider\']","datatype":"","transform":null},{"column":"event_code","path":"$[\'event\'][\'code\']","datatype":"","transform":null},{"column":"event_kind","path":"$[\'event\'][\'kind\']","datatype":"","transform":null},{"column":"event_created","path":"$[\'event\'][\'created\']","datatype":"","transform":null},{"column":"event_module","path":"$[\'event\'][\'module\']","datatype":"","transform":null},{"column":"event_action","path":"$[\'event\'][\'action\']","datatype":"","transform":null},{"column":"event_category","path":"$[\'event\'][\'category\']","datatype":"","transform":null},{"column":"event_type","path":"$[\'event\'][\'type\']","datatype":"","transform":null},{"column":"user_name","path":"$[\'user\'][\'name\']","datatype":"","transform":null},{"column":"user_domain","path":"$[\'user\'][\'domain\']","datatype":"","transform":null},{"column":"user_id","path":"$[\'user\'][\'id\']","datatype":"","transform":null},{"column":"ecs_version","path":"$[\'ecs\'][\'version\']","datatype":"","transform":null},{"column":"winlog_user","path":"$[\'winlog\'][\'user\']","datatype":"","transform":null},{"column":"event_sequence","path":"$[\'event\'][\'sequence\']","datatype":"","transform":null},{"column":"powershell_id","path":"$[\'powershell\'][\'id\']","datatype":"","transform":null},{"column":"powershell_sequence","path":"$[\'powershell\'][\'sequence\']","datatype":"","transform":null},{"column":"powershell_total","path":"$[\'powershell\'][\'total\']","datatype":"","transform":null},{"column":"powershell_engine","path":"$[\'powershell\'][\'engine\']","datatype":"","transform":null},{"column":"powershell_file","path":"$[\'powershell\'][\'file\']","datatype":"","transform":null},{"column":"powershell_command","path":"$[\'powershell\'][\'command\']","datatype":"","transform":null},{"column":"powershell_process","path":"$[\'powershell\'][\'process\']","datatype":"","transform":null},{"column":"powershell_pipeline_id","path":"$[\'powershell\'][\'pipeline_id\']","datatype":"","transform":null},{"column":"powershell_runspace_id","path":"$[\'powershell\'][\'runspace_id\']","datatype":"","transform":null},{"column":"process_command_line","path":"$[\'process\'][\'command_line\']","datatype":"","transform":null},{"column":"process_title","path":"$[\'process\'][\'title\']","datatype":"","transform":null},{"column":"process_args","path":"$[\'process\'][\'args\']","datatype":"","transform":null},{"column":"process_args_count","path":"$[\'process\'][\'args_count\']","datatype":"","transform":null},{"column":"process_entity_id","path":"$[\'process\'][\'entity_id\']","datatype":"","transform":null},{"column":"file_name","path":"$[\'file\'][\'name\']","datatype":"","transform":null},{"column":"file_path","path":"$[\'file\'][\'path\']","datatype":"","transform":null},{"column":"file_directory","path":"$[\'file\'][\'directory\']","datatype":"","transform":null},{"column":"file_extension","path":"$[\'file\'][\'extension\']","datatype":"","transform":null}]'
//winevent Security events json mapping
.create table winevent ingestion json mapping "wineventSeurityJsonMapping" '[{"column":"_timestamp","path":"$[\'@timestamp\']","datatype":"","transform":null},{"column":"log_level","path":"$[\'log\'][\'level\']","datatype":"","transform":null},{"column":"message","path":"$[\'message\']","datatype":"","transform":null},{"column":"related_user","path":"$[\'related\'][\'user\']","datatype":"","transform":null},{"column":"related_ip","path":"$[\'related\'][\'ip\']","datatype":"","transform":null},{"column":"process_executable","path":"$[\'process\'][\'executable\']","datatype":"","transform":null},{"column":"process_name","path":"$[\'process\'][\'name\']","datatype":"","transform":null},{"column":"process_pid","path":"$[\'process\'][\'pid\']","datatype":"","transform":null},{"column":"agent_name","path":"$[\'agent\'][\'name\']","datatype":"","transform":null},{"column":"agent_type","path":"$[\'agent\'][\'type\']","datatype":"","transform":null},{"column":"agent_version","path":"$[\'agent\'][\'version\']","datatype":"","transform":null},{"column":"agent_ephemeral_id","path":"$[\'agent\'][\'ephemeral_id\']","datatype":"","transform":null},{"column":"agent_hostname","path":"$[\'agent\'][\'hostname\']","datatype":"","transform":null},{"column":"agent_id","path":"$[\'agent\'][\'id\']","datatype":"","transform":null},{"column":"host_os","path":"$[\'host\'][\'os\']","datatype":"","transform":null},{"column":"host_mac","path":"$[\'host\'][\'mac\']","datatype":"","transform":null},{"column":"host_id","path":"$[\'host\'][\'id\']","datatype":"","transform":null},{"column":"host_hostname","path":"$[\'host\'][\'hostname\']","datatype":"","transform":null},{"column":"host_ip","path":"$[\'host\'][\'ip\']","datatype":"","transform":null},{"column":"host_name","path":"$[\'host\'][\'name\']","datatype":"","transform":null},{"column":"host_architecture","path":"$[\'host\'][\'architecture\']","datatype":"","transform":null},{"column":"winlog_version","path":"$[\'winlog\'][\'version\']","datatype":"","transform":null},{"column":"winlog_api","path":"$[\'winlog\'][\'api\']","datatype":"","transform":null},{"column":"winlog_opcode","path":"$[\'winlog\'][\'opcode\']","datatype":"","transform":null},{"column":"winlog_provider_guid","path":"$[\'winlog\'][\'provider_guid\']","datatype":"","transform":null},{"column":"winlog_task","path":"$[\'winlog\'][\'task\']","datatype":"","transform":null},{"column":"winlog_activity_id","path":"$[\'winlog\'][\'activity_id\']","datatype":"","transform":null},{"column":"winlog_logon","path":"$[\'winlog\'][\'logon\']","datatype":"","transform":null},{"column":"winlog_record_id","path":"$[\'winlog\'][\'record_id\']","datatype":"","transform":null},{"column":"winlog_keywords","path":"$[\'winlog\'][\'keywords\']","datatype":"","transform":null},{"column":"winlog_process","path":"$[\'winlog\'][\'process\']","datatype":"","transform":null},{"column":"winlog_provider_name","path":"$[\'winlog\'][\'provider_name\']","datatype":"","transform":null},{"column":"winlog_computer_name","path":"$[\'winlog\'][\'computer_name\']","datatype":"","transform":null},{"column":"winlog_event_id","path":"$[\'winlog\'][\'event_id\']","datatype":"","transform":null},{"column":"winlog_channel","path":"$[\'winlog\'][\'channel\']","datatype":"","transform":null},{"column":"winlog_event_data","path":"$[\'winlog\'][\'event_data\']","datatype":"","transform":null},{"column":"event_provider","path":"$[\'event\'][\'provider\']","datatype":"","transform":null},{"column":"event_code","path":"$[\'event\'][\'code\']","datatype":"","transform":null},{"column":"event_kind","path":"$[\'event\'][\'kind\']","datatype":"","transform":null},{"column":"event_created","path":"$[\'event\'][\'created\']","datatype":"","transform":null},{"column":"event_outcome","path":"$[\'event\'][\'outcome\']","datatype":"","transform":null},{"column":"event_module","path":"$[\'event\'][\'module\']","datatype":"","transform":null},{"column":"event_action","path":"$[\'event\'][\'action\']","datatype":"","transform":null},{"column":"event_category","path":"$[\'event\'][\'category\']","datatype":"","transform":null},{"column":"event_type","path":"$[\'event\'][\'type\']","datatype":"","transform":null},{"column":"user_name","path":"$[\'user\'][\'name\']","datatype":"","transform":null},{"column":"user_domain","path":"$[\'user\'][\'domain\']","datatype":"","transform":null},{"column":"user_id","path":"$[\'user\'][\'id\']","datatype":"","transform":null},{"column":"source_port","path":"$[\'source\'][\'port\']","datatype":"","transform":null},{"column":"source_domain","path":"$[\'source\'][\'domain\']","datatype":"","transform":null},{"column":"source_ip","path":"$[\'source\'][\'ip\']","datatype":"","transform":null},{"column":"ecs_version","path":"$[\'ecs\'][\'version\']","datatype":"","transform":null}]'
//winevent System events json mapping
.create table winevent ingestion json mapping "wineventSystemJsonMapping" '[{"column":"_timestamp","path":"$[\'@timestamp\']","datatype":"","transform":null},{"column":"log_level","path":"$[\'log\'][\'level\']","datatype":"","transform":null},{"column":"message","path":"$[\'message\']","datatype":"","transform":null},{"column":"agent_name","path":"$[\'agent\'][\'name\']","datatype":"","transform":null},{"column":"agent_type","path":"$[\'agent\'][\'type\']","datatype":"","transform":null},{"column":"agent_version","path":"$[\'agent\'][\'version\']","datatype":"","transform":null},{"column":"agent_ephemeral_id","path":"$[\'agent\'][\'ephemeral_id\']","datatype":"","transform":null},{"column":"agent_hostname","path":"$[\'agent\'][\'hostname\']","datatype":"","transform":null},{"column":"agent_id","path":"$[\'agent\'][\'id\']","datatype":"","transform":null},{"column":"host_os","path":"$[\'host\'][\'os\']","datatype":"","transform":null},{"column":"host_mac","path":"$[\'host\'][\'mac\']","datatype":"","transform":null},{"column":"host_id","path":"$[\'host\'][\'id\']","datatype":"","transform":null},{"column":"host_hostname","path":"$[\'host\'][\'hostname\']","datatype":"","transform":null},{"column":"host_ip","path":"$[\'host\'][\'ip\']","datatype":"","transform":null},{"column":"host_name","path":"$[\'host\'][\'name\']","datatype":"","transform":null},{"column":"host_architecture","path":"$[\'host\'][\'architecture\']","datatype":"","transform":null},{"column":"winlog_api","path":"$[\'winlog\'][\'api\']","datatype":"","transform":null},{"column":"winlog_provider_guid","path":"$[\'winlog\'][\'provider_guid\']","datatype":"","transform":null},{"column":"winlog_record_id","path":"$[\'winlog\'][\'record_id\']","datatype":"","transform":null},{"column":"winlog_keywords","path":"$[\'winlog\'][\'keywords\']","datatype":"","transform":null},{"column":"winlog_process","path":"$[\'winlog\'][\'process\']","datatype":"","transform":null},{"column":"winlog_provider_name","path":"$[\'winlog\'][\'provider_name\']","datatype":"","transform":null},{"column":"winlog_computer_name","path":"$[\'winlog\'][\'computer_name\']","datatype":"","transform":null},{"column":"winlog_event_id","path":"$[\'winlog\'][\'event_id\']","datatype":"","transform":null},{"column":"winlog_channel","path":"$[\'winlog\'][\'channel\']","datatype":"","transform":null},{"column":"winlog_event_data","path":"$[\'winlog\'][\'event_data\']","datatype":"","transform":null},{"column":"event_provider","path":"$[\'event\'][\'provider\']","datatype":"","transform":null},{"column":"event_code","path":"$[\'event\'][\'code\']","datatype":"","transform":null},{"column":"event_kind","path":"$[\'event\'][\'kind\']","datatype":"","transform":null},{"column":"event_created","path":"$[\'event\'][\'created\']","datatype":"","transform":null},{"column":"ecs_version","path":"$[\'ecs\'][\'version\']","datatype":"","transform":null},{"column":"winlog_user","path":"$[\'winlog\'][\'user\']","datatype":"","transform":null}]'

// need to look into zeek mapping as there is 6 on the existing table
//.show table zeek ingestion json mappings
//| extend formatted_mapping = strcat("'",replace_string(Mapping, "'", "\\'"),"'")
//| project formatted_mapping

//timeline csv mapping
.create table timeline ingestion csv mapping'[{"Name":"date","DataType":"","Ordinal":"0","ConstValue":null},{"Name":"time","DataType":"","Ordinal":"1","ConstValue":null},{"Name":"timezone","DataType":"","Ordinal":"2","ConstValue":null},{"Name":"MACB","DataType":"","Ordinal":"3","ConstValue":null},{"Name":"source","DataType":"","Ordinal":"4","ConstValue":null},{"Name":"sourcetype","DataType":"","Ordinal":"5","ConstValue":null},{"Name":"type","DataType":"","Ordinal":"6","ConstValue":null},{"Name":"user","DataType":"","Ordinal":"7","ConstValue":null},{"Name":"host","DataType":"","Ordinal":"8","ConstValue":null},{"Name":"short","DataType":"","Ordinal":"9","ConstValue":null},{"Name":"desc","DataType":"","Ordinal":"10","ConstValue":null},{"Name":"version","DataType":"","Ordinal":"11","ConstValue":null},{"Name":"filename","DataType":"","Ordinal":"12","ConstValue":null},{"Name":"inode","DataType":"","Ordinal":"13","ConstValue":null},{"Name":"notes","DataType":"","Ordinal":"14","ConstValue":null},{"Name":"format","DataType":"","Ordinal":"15","ConstValue":null},{"Name":"extra","DataType":"","Ordinal":"16","ConstValue":null}]'

