//Create schema for tables and mappings
//sysmon
.create-merge table zsysmonraw (_timestamp:datetime,host_name:string,host_id:guid,host_mac:dynamic,host_ip:dynamic,host_hostname:string,host_architecture:string,host_os_kernel:string,host_os_build:string,host_os_type:string,host_os_platform:string,host_os_version:string,host_os_family:string,host_os_name:string,rule_name:string,registry_key:string,registry_value_0:string,registry_value_1:guid,registry_path:string,registry_hive:string,registry_data_strings:dynamic,registry_data_type:string,agent_id:guid,agent_name:string,agent_type:string,agent_version:string,agent_ephemeral_id:guid,agent_hostname:string,event_type:dynamic,event_module:string,event_category:dynamic,event_kind:string,event_created:datetime,event_provider:string,event_code:string,event_action:string,log_level:string,message:string,winlog_process_pid:long,winlog_process_thread:dynamic,winlog_user_name:string,winlog_user_identifier:string,winlog_user_domain:string,winlog_user_type:string,winlog_provider_name:string,winlog_task:string,winlog_channel:string,winlog_record_id:long,winlog_computer_name:string,winlog_event_data_EventType:string,winlog_event_data_TargetObject:string,winlog_event_data_User:string,winlog_event_data_CreationUtcTime:datetime,winlog_event_data_Details:string,winlog_event_data_Product:string,winlog_event_data_Company:string,winlog_event_data_Description:string,winlog_event_data_Signed:string,winlog_event_data_Signature:string,winlog_event_data_SignatureStatus:string,winlog_event_data_FileVersion:string,winlog_version:long,winlog_api:string,winlog_opcode:string,winlog_provider_guid:string,winlog_event_id:string,process_pid:long,process_entity_id:string,process_executable:string,process_name:string,ecs_version:string,file_pe_imphash:string,file_pe_description:string,file_pe_original_file_name:string,file_pe_product:string,file_pe_company:string,file_pe_file_version:string,file_name:string,file_path:string,file_directory:string,file_extension:string,file_code_signature_subject_name:string,file_code_signature_status:string,file_code_signature_signed:bool,file_code_signature_valid:bool,file_hash_md5:string,file_hash_sha256:string,file_hash_sha1:string,hash_sha1:string,hash_md5:string,hash_sha256:string,hash_imphash:string,related_hash:dynamic)  with (folder = "Raw", docstring = "Raw table for sysmon")

//sysmon json mapping
.create table zsysmonraw ingestion json mapping "sysmonJsonMapping" '[{"column":"_timestamp","path":"$[\'@timestamp\']","datatype":"","transform":null},{"column":"host_name","path":"$[\'host\'][\'name\']","datatype":"","transform":null},{"column":"host_id","path":"$[\'host\'][\'id\']","datatype":"","transform":null},{"column":"host_mac","path":"$[\'host\'][\'mac\']","datatype":"","transform":null},{"column":"host_ip","path":"$[\'host\'][\'ip\']","datatype":"","transform":null},{"column":"host_hostname","path":"$[\'host\'][\'hostname\']","datatype":"","transform":null},{"column":"host_architecture","path":"$[\'host\'][\'architecture\']","datatype":"","transform":null},{"column":"host_os_kernel","path":"$[\'host\'][\'os\'][\'kernel\']","datatype":"","transform":null},{"column":"host_os_build","path":"$[\'host\'][\'os\'][\'build\']","datatype":"","transform":null},{"column":"host_os_type","path":"$[\'host\'][\'os\'][\'type\']","datatype":"","transform":null},{"column":"host_os_platform","path":"$[\'host\'][\'os\'][\'platform\']","datatype":"","transform":null},{"column":"host_os_version","path":"$[\'host\'][\'os\'][\'version\']","datatype":"","transform":null},{"column":"host_os_family","path":"$[\'host\'][\'os\'][\'family\']","datatype":"","transform":null},{"column":"host_os_name","path":"$[\'host\'][\'os\'][\'name\']","datatype":"","transform":null},{"column":"rule_name","path":"$[\'rule\'][\'name\']","datatype":"","transform":null},{"column":"registry_key","path":"$[\'registry\'][\'key\']","datatype":"","transform":null},{"column":"registry_value_0","path":"$[\'registry\'][\'value\'][\'0\']","datatype":"","transform":null},{"column":"registry_value_1","path":"$[\'registry\'][\'value\'][\'1\']","datatype":"","transform":null},{"column":"registry_path","path":"$[\'registry\'][\'path\']","datatype":"","transform":null},{"column":"registry_hive","path":"$[\'registry\'][\'hive\']","datatype":"","transform":null},{"column":"registry_data_strings","path":"$[\'registry\'][\'data\'][\'strings\']","datatype":"","transform":null},{"column":"registry_data_type","path":"$[\'registry\'][\'data\'][\'type\']","datatype":"","transform":null},{"column":"agent_id","path":"$[\'agent\'][\'id\']","datatype":"","transform":null},{"column":"agent_name","path":"$[\'agent\'][\'name\']","datatype":"","transform":null},{"column":"agent_type","path":"$[\'agent\'][\'type\']","datatype":"","transform":null},{"column":"agent_version","path":"$[\'agent\'][\'version\']","datatype":"","transform":null},{"column":"agent_ephemeral_id","path":"$[\'agent\'][\'ephemeral_id\']","datatype":"","transform":null},{"column":"agent_hostname","path":"$[\'agent\'][\'hostname\']","datatype":"","transform":null},{"column":"event_type","path":"$[\'event\'][\'type\']","datatype":"","transform":null},{"column":"event_module","path":"$[\'event\'][\'module\']","datatype":"","transform":null},{"column":"event_category","path":"$[\'event\'][\'category\']","datatype":"","transform":null},{"column":"event_kind","path":"$[\'event\'][\'kind\']","datatype":"","transform":null},{"column":"event_created","path":"$[\'event\'][\'created\']","datatype":"","transform":null},{"column":"event_provider","path":"$[\'event\'][\'provider\']","datatype":"","transform":null},{"column":"event_code","path":"$[\'event\'][\'code\']","datatype":"","transform":null},{"column":"event_action","path":"$[\'event\'][\'action\']","datatype":"","transform":null},{"column":"log_level","path":"$[\'log\'][\'level\']","datatype":"","transform":null},{"column":"message","path":"$[\'message\']","datatype":"","transform":null},{"column":"winlog_process_pid","path":"$[\'winlog\'][\'process\'][\'pid\']","datatype":"","transform":null},{"column":"winlog_process_thread","path":"$[\'winlog\'][\'process\'][\'thread\']","datatype":"","transform":null},{"column":"winlog_user_name","path":"$[\'winlog\'][\'user\'][\'name\']","datatype":"","transform":null},{"column":"winlog_user_identifier","path":"$[\'winlog\'][\'user\'][\'identifier\']","datatype":"","transform":null},{"column":"winlog_user_domain","path":"$[\'winlog\'][\'user\'][\'domain\']","datatype":"","transform":null},{"column":"winlog_user_type","path":"$[\'winlog\'][\'user\'][\'type\']","datatype":"","transform":null},{"column":"winlog_provider_name","path":"$[\'winlog\'][\'provider_name\']","datatype":"","transform":null},{"column":"winlog_task","path":"$[\'winlog\'][\'task\']","datatype":"","transform":null},{"column":"winlog_channel","path":"$[\'winlog\'][\'channel\']","datatype":"","transform":null},{"column":"winlog_record_id","path":"$[\'winlog\'][\'record_id\']","datatype":"","transform":null},{"column":"winlog_computer_name","path":"$[\'winlog\'][\'computer_name\']","datatype":"","transform":null},{"column":"winlog_event_data_EventType","path":"$[\'winlog\'][\'event_data\'][\'EventType\']","datatype":"","transform":null},{"column":"winlog_event_data_TargetObject","path":"$[\'winlog\'][\'event_data\'][\'TargetObject\']","datatype":"","transform":null},{"column":"winlog_event_data_User","path":"$[\'winlog\'][\'event_data\'][\'User\']","datatype":"","transform":null},{"column":"winlog_event_data_CreationUtcTime","path":"$[\'winlog\'][\'event_data\'][\'CreationUtcTime\']","datatype":"","transform":null},{"column":"winlog_event_data_Details","path":"$[\'winlog\'][\'event_data\'][\'Details\']","datatype":"","transform":null},{"column":"winlog_event_data_Product","path":"$[\'winlog\'][\'event_data\'][\'Product\']","datatype":"","transform":null},{"column":"winlog_event_data_Company","path":"$[\'winlog\'][\'event_data\'][\'Company\']","datatype":"","transform":null},{"column":"winlog_event_data_Description","path":"$[\'winlog\'][\'event_data\'][\'Description\']","datatype":"","transform":null},{"column":"winlog_event_data_Signed","path":"$[\'winlog\'][\'event_data\'][\'Signed\']","datatype":"","transform":null},{"column":"winlog_event_data_Signature","path":"$[\'winlog\'][\'event_data\'][\'Signature\']","datatype":"","transform":null},{"column":"winlog_event_data_SignatureStatus","path":"$[\'winlog\'][\'event_data\'][\'SignatureStatus\']","datatype":"","transform":null},{"column":"winlog_event_data_FileVersion","path":"$[\'winlog\'][\'event_data\'][\'FileVersion\']","datatype":"","transform":null},{"column":"winlog_version","path":"$[\'winlog\'][\'version\']","datatype":"","transform":null},{"column":"winlog_api","path":"$[\'winlog\'][\'api\']","datatype":"","transform":null},{"column":"winlog_opcode","path":"$[\'winlog\'][\'opcode\']","datatype":"","transform":null},{"column":"winlog_provider_guid","path":"$[\'winlog\'][\'provider_guid\']","datatype":"","transform":null},{"column":"winlog_event_id","path":"$[\'winlog\'][\'event_id\']","datatype":"","transform":null},{"column":"process_pid","path":"$[\'process\'][\'pid\']","datatype":"","transform":null},{"column":"process_entity_id","path":"$[\'process\'][\'entity_id\']","datatype":"","transform":null},{"column":"process_executable","path":"$[\'process\'][\'executable\']","datatype":"","transform":null},{"column":"process_name","path":"$[\'process\'][\'name\']","datatype":"","transform":null},{"column":"ecs_version","path":"$[\'ecs\'][\'version\']","datatype":"","transform":null},{"column":"file_pe_imphash","path":"$[\'file\'][\'pe\'][\'imphash\']","datatype":"","transform":null},{"column":"file_pe_description","path":"$[\'file\'][\'pe\'][\'description\']","datatype":"","transform":null},{"column":"file_pe_original_file_name","path":"$[\'file\'][\'pe\'][\'original_file_name\']","datatype":"","transform":null},{"column":"file_pe_product","path":"$[\'file\'][\'pe\'][\'product\']","datatype":"","transform":null},{"column":"file_pe_company","path":"$[\'file\'][\'pe\'][\'company\']","datatype":"","transform":null},{"column":"file_pe_file_version","path":"$[\'file\'][\'pe\'][\'file_version\']","datatype":"","transform":null},{"column":"file_name","path":"$[\'file\'][\'name\']","datatype":"","transform":null},{"column":"file_path","path":"$[\'file\'][\'path\']","datatype":"","transform":null},{"column":"file_directory","path":"$[\'file\'][\'directory\']","datatype":"","transform":null},{"column":"file_extension","path":"$[\'file\'][\'extension\']","datatype":"","transform":null},{"column":"file_code_signature_subject_name","path":"$[\'file\'][\'code_signature\'][\'subject_name\']","datatype":"","transform":null},{"column":"file_code_signature_status","path":"$[\'file\'][\'code_signature\'][\'status\']","datatype":"","transform":null},{"column":"file_code_signature_signed","path":"$[\'file\'][\'code_signature\'][\'signed\']","datatype":"","transform":null},{"column":"file_code_signature_valid","path":"$[\'file\'][\'code_signature\'][\'valid\']","datatype":"","transform":null},{"column":"file_hash_md5","path":"$[\'file\'][\'hash\'][\'md5\']","datatype":"","transform":null},{"column":"file_hash_sha256","path":"$[\'file\'][\'hash\'][\'sha256\']","datatype":"","transform":null},{"column":"file_hash_sha1","path":"$[\'file\'][\'hash\'][\'sha1\']","datatype":"","transform":null},{"column":"hash_sha1","path":"$[\'hash\'][\'sha1\']","datatype":"","transform":null},{"column":"hash_md5","path":"$[\'hash\'][\'md5\']","datatype":"","transform":null},{"column":"hash_sha256","path":"$[\'hash\'][\'sha256\']","datatype":"","transform":null},{"column":"hash_imphash","path":"$[\'hash\'][\'imphash\']","datatype":"","transform":null},{"column":"related_hash","path":"$[\'related\'][\'hash\']","datatype":"","transform":null}]'

//winevent 
.create-merge table zeventraw(_timestamp:datetime,log_level:string,message:string,related_user:string,related_ip:string,process_executable:string,process_name:string,process_pid:long,agent_name:string,agent_type:string,agent_version:string,agent_ephemeral_id:guid,agent_hostname:string,agent_id:guid,host_os:dynamic,host_mac:dynamic,host_id:guid,host_hostname:string,host_ip:dynamic,host_name:string,host_architecture:string,winlog_version:long,winlog_api:string,winlog_opcode:string,winlog_provider_guid:string,winlog_task:string,winlog_activity_id:string,winlog_logon:dynamic,winlog_record_id:long,winlog_keywords:dynamic,winlog_process:dynamic,winlog_provider_name:string,winlog_computer_name:string,winlog_event_id:string,winlog_channel:string,winlog_event_data:dynamic,event_provider:string,event_code:string,event_kind:string,event_created:datetime,event_outcome:string,event_module:string,event_action:string,event_category:dynamic,event_type:dynamic,user_name:string,user_domain:string,user_id:string,source_port:long,source_domain:string,source_ip:string,ecs_version:string,winlog_user:dynamic,event_sequence:long,powershell_id:string,powershell_sequence:long,powershell_total:long,powershell_engine:dynamic,powershell_file:dynamic,powershell_command:dynamic,powershell_process:dynamic,powershell_pipeline_id:string,powershell_runspace_id:guid,process_command_line:string,process_title:string,process_args:dynamic,process_args_count:long,process_entity_id:guid,file_name:string,file_path:string,file_directory:string,file_extension:string) with (folder = "Raw", docstring = "Raw table for windows events")

.create-merge table zeventraw(_timestamp:datetime,log_level:string,message:string,related_user:string,related_ip:string,process_executable:string,process_name:string,process_pid:long,agent_name:string,agent_type:string,agent_version:string,agent_ephemeral_id:guid,agent_hostname:string,agent_id:guid,host_os:dynamic,host_mac:dynamic,host_id:guid,host_hostname:string,host_ip:dynamic,host_name:string,host_architecture:string,winlog_version:long,winlog_api:string,winlog_opcode:string,winlog_provider_guid:string,winlog_task:string,winlog_activity_id:string,winlog_logon:dynamic,winlog_record_id:long,winlog_keywords:dynamic,winlog_process:dynamic,winlog_provider_name:string,winlog_computer_name:string,winlog_event_id:string,winlog_channel:string,winlog_event_data:dynamic,event_provider:string,event_code:string,event_kind:string,event_created:datetime,event_outcome:string,event_module:string,event_action:string,event_category:dynamic,event_type:dynamic,user_name:string,user_domain:string,user_id:string,source_port:long,source_domain:string,source_ip:string,ecs_version:string,winlog_user:dynamic,event_sequence:long,powershell_id:string,powershell_sequence:long,powershell_total:long,powershell_engine:dynamic,powershell_file:dynamic,powershell_command:dynamic,powershell_process:dynamic,powershell_pipeline_id:string,powershell_runspace_id:guid,process_command_line:string,process_title:string,process_args:dynamic,process_args_count:long,process_entity_id:guid,file_name:string,file_path:string,file_directory:string,file_extension:string,winlog_user_data_Address:string,winlog_user_data_SessionID:string,winlog_user_data_Reason:string,winlog_user_data_xml_name:string,winlog_user_data_User:string,winlog_user_data_Session:string,winlog_user_type:string,winlog_user_identifier:string,winlog_user_domain:string,winlog_user_name:string,winlog_process_pid:long,winlog_process_thread:dynamic,host_os_version:string,host_os_name:string,host_os_kernel:string,host_os_build:string,host_os_type:string,host_os_platform:string,host_os_family:string) with (folder = "Raw", docstring = "Raw table for windows events")

//winevent powershell zeventsraw json mapping
.create table zeventraw ingestion json mapping "eventPowershellJsonMapping" '[{"column":"_timestamp","path":"$[\'@timestamp\']","datatype":"","transform":null},{"column":"log_level","path":"$[\'log\'][\'level\']","datatype":"","transform":null},{"column":"message","path":"$[\'message\']","datatype":"","transform":null},{"column":"related_user","path":"$[\'related\'][\'user\']","datatype":"","transform":null},{"column":"agent_name","path":"$[\'agent\'][\'name\']","datatype":"","transform":null},{"column":"agent_type","path":"$[\'agent\'][\'type\']","datatype":"","transform":null},{"column":"agent_version","path":"$[\'agent\'][\'version\']","datatype":"","transform":null},{"column":"agent_ephemeral_id","path":"$[\'agent\'][\'ephemeral_id\']","datatype":"","transform":null},{"column":"agent_hostname","path":"$[\'agent\'][\'hostname\']","datatype":"","transform":null},{"column":"agent_id","path":"$[\'agent\'][\'id\']","datatype":"","transform":null},{"column":"host_os","path":"$[\'host\'][\'os\']","datatype":"","transform":null},{"column":"host_mac","path":"$[\'host\'][\'mac\']","datatype":"","transform":null},{"column":"host_id","path":"$[\'host\'][\'id\']","datatype":"","transform":null},{"column":"host_hostname","path":"$[\'host\'][\'hostname\']","datatype":"","transform":null},{"column":"host_ip","path":"$[\'host\'][\'ip\']","datatype":"","transform":null},{"column":"host_name","path":"$[\'host\'][\'name\']","datatype":"","transform":null},{"column":"host_architecture","path":"$[\'host\'][\'architecture\']","datatype":"","transform":null},{"column":"winlog_version","path":"$[\'winlog\'][\'version\']","datatype":"","transform":null},{"column":"winlog_api","path":"$[\'winlog\'][\'api\']","datatype":"","transform":null},{"column":"winlog_opcode","path":"$[\'winlog\'][\'opcode\']","datatype":"","transform":null},{"column":"winlog_provider_guid","path":"$[\'winlog\'][\'provider_guid\']","datatype":"","transform":null},{"column":"winlog_task","path":"$[\'winlog\'][\'task\']","datatype":"","transform":null},{"column":"winlog_activity_id","path":"$[\'winlog\'][\'activity_id\']","datatype":"","transform":null},{"column":"winlog_record_id","path":"$[\'winlog\'][\'record_id\']","datatype":"","transform":null},{"column":"winlog_process","path":"$[\'winlog\'][\'process\']","datatype":"","transform":null},{"column":"winlog_provider_name","path":"$[\'winlog\'][\'provider_name\']","datatype":"","transform":null},{"column":"winlog_computer_name","path":"$[\'winlog\'][\'computer_name\']","datatype":"","transform":null},{"column":"winlog_event_id","path":"$[\'winlog\'][\'event_id\']","datatype":"","transform":null},{"column":"winlog_channel","path":"$[\'winlog\'][\'channel\']","datatype":"","transform":null},{"column":"event_provider","path":"$[\'event\'][\'provider\']","datatype":"","transform":null},{"column":"event_code","path":"$[\'event\'][\'code\']","datatype":"","transform":null},{"column":"event_kind","path":"$[\'event\'][\'kind\']","datatype":"","transform":null},{"column":"event_created","path":"$[\'event\'][\'created\']","datatype":"","transform":null},{"column":"event_module","path":"$[\'event\'][\'module\']","datatype":"","transform":null},{"column":"event_action","path":"$[\'event\'][\'action\']","datatype":"","transform":null},{"column":"event_category","path":"$[\'event\'][\'category\']","datatype":"","transform":null},{"column":"event_type","path":"$[\'event\'][\'type\']","datatype":"","transform":null},{"column":"user_name","path":"$[\'user\'][\'name\']","datatype":"","transform":null},{"column":"user_domain","path":"$[\'user\'][\'domain\']","datatype":"","transform":null},{"column":"user_id","path":"$[\'user\'][\'id\']","datatype":"","transform":null},{"column":"ecs_version","path":"$[\'ecs\'][\'version\']","datatype":"","transform":null},{"column":"winlog_user","path":"$[\'winlog\'][\'user\']","datatype":"","transform":null},{"column":"event_sequence","path":"$[\'event\'][\'sequence\']","datatype":"","transform":null},{"column":"powershell_id","path":"$[\'powershell\'][\'id\']","datatype":"","transform":null},{"column":"powershell_sequence","path":"$[\'powershell\'][\'sequence\']","datatype":"","transform":null},{"column":"powershell_total","path":"$[\'powershell\'][\'total\']","datatype":"","transform":null},{"column":"powershell_engine","path":"$[\'powershell\'][\'engine\']","datatype":"","transform":null},{"column":"powershell_file","path":"$[\'powershell\'][\'file\']","datatype":"","transform":null},{"column":"powershell_command","path":"$[\'powershell\'][\'command\']","datatype":"","transform":null},{"column":"powershell_process","path":"$[\'powershell\'][\'process\']","datatype":"","transform":null},{"column":"powershell_pipeline_id","path":"$[\'powershell\'][\'pipeline_id\']","datatype":"","transform":null},{"column":"powershell_runspace_id","path":"$[\'powershell\'][\'runspace_id\']","datatype":"","transform":null},{"column":"process_command_line","path":"$[\'process\'][\'command_line\']","datatype":"","transform":null},{"column":"process_title","path":"$[\'process\'][\'title\']","datatype":"","transform":null},{"column":"process_args","path":"$[\'process\'][\'args\']","datatype":"","transform":null},{"column":"process_args_count","path":"$[\'process\'][\'args_count\']","datatype":"","transform":null},{"column":"process_entity_id","path":"$[\'process\'][\'entity_id\']","datatype":"","transform":null},{"column":"file_name","path":"$[\'file\'][\'name\']","datatype":"","transform":null},{"column":"file_path","path":"$[\'file\'][\'path\']","datatype":"","transform":null},{"column":"file_directory","path":"$[\'file\'][\'directory\']","datatype":"","transform":null},{"column":"file_extension","path":"$[\'file\'][\'extension\']","datatype":"","transform":null}]'

//winevent Security events json mapping
.create table zeventraw ingestion json mapping "eventSecurityJsonMapping" '[{"column":"_timestamp","path":"$[\'@timestamp\']","datatype":"","transform":null},{"column":"log_level","path":"$[\'log\'][\'level\']","datatype":"","transform":null},{"column":"message","path":"$[\'message\']","datatype":"","transform":null},{"column":"related_user","path":"$[\'related\'][\'user\']","datatype":"","transform":null},{"column":"related_ip","path":"$[\'related\'][\'ip\']","datatype":"","transform":null},{"column":"process_executable","path":"$[\'process\'][\'executable\']","datatype":"","transform":null},{"column":"process_name","path":"$[\'process\'][\'name\']","datatype":"","transform":null},{"column":"process_pid","path":"$[\'process\'][\'pid\']","datatype":"","transform":null},{"column":"agent_name","path":"$[\'agent\'][\'name\']","datatype":"","transform":null},{"column":"agent_type","path":"$[\'agent\'][\'type\']","datatype":"","transform":null},{"column":"agent_version","path":"$[\'agent\'][\'version\']","datatype":"","transform":null},{"column":"agent_ephemeral_id","path":"$[\'agent\'][\'ephemeral_id\']","datatype":"","transform":null},{"column":"agent_hostname","path":"$[\'agent\'][\'hostname\']","datatype":"","transform":null},{"column":"agent_id","path":"$[\'agent\'][\'id\']","datatype":"","transform":null},{"column":"host_os","path":"$[\'host\'][\'os\']","datatype":"","transform":null},{"column":"host_mac","path":"$[\'host\'][\'mac\']","datatype":"","transform":null},{"column":"host_id","path":"$[\'host\'][\'id\']","datatype":"","transform":null},{"column":"host_hostname","path":"$[\'host\'][\'hostname\']","datatype":"","transform":null},{"column":"host_ip","path":"$[\'host\'][\'ip\']","datatype":"","transform":null},{"column":"host_name","path":"$[\'host\'][\'name\']","datatype":"","transform":null},{"column":"host_architecture","path":"$[\'host\'][\'architecture\']","datatype":"","transform":null},{"column":"winlog_version","path":"$[\'winlog\'][\'version\']","datatype":"","transform":null},{"column":"winlog_api","path":"$[\'winlog\'][\'api\']","datatype":"","transform":null},{"column":"winlog_opcode","path":"$[\'winlog\'][\'opcode\']","datatype":"","transform":null},{"column":"winlog_provider_guid","path":"$[\'winlog\'][\'provider_guid\']","datatype":"","transform":null},{"column":"winlog_task","path":"$[\'winlog\'][\'task\']","datatype":"","transform":null},{"column":"winlog_activity_id","path":"$[\'winlog\'][\'activity_id\']","datatype":"","transform":null},{"column":"winlog_logon","path":"$[\'winlog\'][\'logon\']","datatype":"","transform":null},{"column":"winlog_record_id","path":"$[\'winlog\'][\'record_id\']","datatype":"","transform":null},{"column":"winlog_keywords","path":"$[\'winlog\'][\'keywords\']","datatype":"","transform":null},{"column":"winlog_process","path":"$[\'winlog\'][\'process\']","datatype":"","transform":null},{"column":"winlog_provider_name","path":"$[\'winlog\'][\'provider_name\']","datatype":"","transform":null},{"column":"winlog_computer_name","path":"$[\'winlog\'][\'computer_name\']","datatype":"","transform":null},{"column":"winlog_event_id","path":"$[\'winlog\'][\'event_id\']","datatype":"","transform":null},{"column":"winlog_channel","path":"$[\'winlog\'][\'channel\']","datatype":"","transform":null},{"column":"winlog_event_data","path":"$[\'winlog\'][\'event_data\']","datatype":"","transform":null},{"column":"event_provider","path":"$[\'event\'][\'provider\']","datatype":"","transform":null},{"column":"event_code","path":"$[\'event\'][\'code\']","datatype":"","transform":null},{"column":"event_kind","path":"$[\'event\'][\'kind\']","datatype":"","transform":null},{"column":"event_created","path":"$[\'event\'][\'created\']","datatype":"","transform":null},{"column":"event_outcome","path":"$[\'event\'][\'outcome\']","datatype":"","transform":null},{"column":"event_module","path":"$[\'event\'][\'module\']","datatype":"","transform":null},{"column":"event_action","path":"$[\'event\'][\'action\']","datatype":"","transform":null},{"column":"event_category","path":"$[\'event\'][\'category\']","datatype":"","transform":null},{"column":"event_type","path":"$[\'event\'][\'type\']","datatype":"","transform":null},{"column":"user_name","path":"$[\'user\'][\'name\']","datatype":"","transform":null},{"column":"user_domain","path":"$[\'user\'][\'domain\']","datatype":"","transform":null},{"column":"user_id","path":"$[\'user\'][\'id\']","datatype":"","transform":null},{"column":"source_port","path":"$[\'source\'][\'port\']","datatype":"","transform":null},{"column":"source_domain","path":"$[\'source\'][\'domain\']","datatype":"","transform":null},{"column":"source_ip","path":"$[\'source\'][\'ip\']","datatype":"","transform":null},{"column":"ecs_version","path":"$[\'ecs\'][\'version\']","datatype":"","transform":null}]'

//winevent System events json mapping
.create table zeventraw ingestion json mapping "eventSystemJsonMapping" '[{"column":"_timestamp","path":"$[\'@timestamp\']","datatype":"","transform":null},{"column":"log_level","path":"$[\'log\'][\'level\']","datatype":"","transform":null},{"column":"message","path":"$[\'message\']","datatype":"","transform":null},{"column":"agent_name","path":"$[\'agent\'][\'name\']","datatype":"","transform":null},{"column":"agent_type","path":"$[\'agent\'][\'type\']","datatype":"","transform":null},{"column":"agent_version","path":"$[\'agent\'][\'version\']","datatype":"","transform":null},{"column":"agent_ephemeral_id","path":"$[\'agent\'][\'ephemeral_id\']","datatype":"","transform":null},{"column":"agent_hostname","path":"$[\'agent\'][\'hostname\']","datatype":"","transform":null},{"column":"agent_id","path":"$[\'agent\'][\'id\']","datatype":"","transform":null},{"column":"host_os","path":"$[\'host\'][\'os\']","datatype":"","transform":null},{"column":"host_mac","path":"$[\'host\'][\'mac\']","datatype":"","transform":null},{"column":"host_id","path":"$[\'host\'][\'id\']","datatype":"","transform":null},{"column":"host_hostname","path":"$[\'host\'][\'hostname\']","datatype":"","transform":null},{"column":"host_ip","path":"$[\'host\'][\'ip\']","datatype":"","transform":null},{"column":"host_name","path":"$[\'host\'][\'name\']","datatype":"","transform":null},{"column":"host_architecture","path":"$[\'host\'][\'architecture\']","datatype":"","transform":null},{"column":"winlog_api","path":"$[\'winlog\'][\'api\']","datatype":"","transform":null},{"column":"winlog_provider_guid","path":"$[\'winlog\'][\'provider_guid\']","datatype":"","transform":null},{"column":"winlog_record_id","path":"$[\'winlog\'][\'record_id\']","datatype":"","transform":null},{"column":"winlog_keywords","path":"$[\'winlog\'][\'keywords\']","datatype":"","transform":null},{"column":"winlog_process","path":"$[\'winlog\'][\'process\']","datatype":"","transform":null},{"column":"winlog_provider_name","path":"$[\'winlog\'][\'provider_name\']","datatype":"","transform":null},{"column":"winlog_computer_name","path":"$[\'winlog\'][\'computer_name\']","datatype":"","transform":null},{"column":"winlog_event_id","path":"$[\'winlog\'][\'event_id\']","datatype":"","transform":null},{"column":"winlog_channel","path":"$[\'winlog\'][\'channel\']","datatype":"","transform":null},{"column":"winlog_event_data","path":"$[\'winlog\'][\'event_data\']","datatype":"","transform":null},{"column":"event_provider","path":"$[\'event\'][\'provider\']","datatype":"","transform":null},{"column":"event_code","path":"$[\'event\'][\'code\']","datatype":"","transform":null},{"column":"event_kind","path":"$[\'event\'][\'kind\']","datatype":"","transform":null},{"column":"event_created","path":"$[\'event\'][\'created\']","datatype":"","transform":null},{"column":"ecs_version","path":"$[\'ecs\'][\'version\']","datatype":"","transform":null},{"column":"winlog_user","path":"$[\'winlog\'][\'user\']","datatype":"","transform":null}]'

//winevent TerminalServices events json mapping
.create table zeventraw ingestion json mapping "eventTerminalServicesJsonMapping" '[{"column":"_timestamp", "Properties":{"Path":"$[\'@timestamp\']"}},{"column":"log_level", "Properties":{"Path":"$[\'log\'][\'level\']"}},{"column":"message", "Properties":{"Path":"$[\'message\']"}},{"column":"agent_name", "Properties":{"Path":"$[\'agent\'][\'name\']"}},{"column":"agent_type", "Properties":{"Path":"$[\'agent\'][\'type\']"}},{"column":"agent_version", "Properties":{"Path":"$[\'agent\'][\'version\']"}},{"column":"agent_ephemeral_id", "Properties":{"Path":"$[\'agent\'][\'ephemeral_id\']"}},{"column":"agent_hostname", "Properties":{"Path":"$[\'agent\'][\'hostname\']"}},{"column":"agent_id", "Properties":{"Path":"$[\'agent\'][\'id\']"}},{"column":"host_mac", "Properties":{"Path":"$[\'host\'][\'mac\']"}},{"column":"host_id", "Properties":{"Path":"$[\'host\'][\'id\']"}},{"column":"host_hostname", "Properties":{"Path":"$[\'host\'][\'hostname\']"}},{"column":"host_ip", "Properties":{"Path":"$[\'host\'][\'ip\']"}},{"column":"host_name", "Properties":{"Path":"$[\'host\'][\'name\']"}},{"column":"host_architecture", "Properties":{"Path":"$[\'host\'][\'architecture\']"}},{"column":"winlog_api", "Properties":{"Path":"$[\'winlog\'][\'api\']"}},{"column":"winlog_opcode", "Properties":{"Path":"$[\'winlog\'][\'opcode\']"}},{"column":"winlog_provider_guid", "Properties":{"Path":"$[\'winlog\'][\'provider_guid\']"}},{"column":"winlog_activity_id", "Properties":{"Path":"$[\'winlog\'][\'activity_id\']"}},{"column":"winlog_record_id", "Properties":{"Path":"$[\'winlog\'][\'record_id\']"}},{"column":"winlog_provider_name", "Properties":{"Path":"$[\'winlog\'][\'provider_name\']"}},{"column":"winlog_computer_name", "Properties":{"Path":"$[\'winlog\'][\'computer_name\']"}},{"column":"winlog_event_id", "Properties":{"Path":"$[\'winlog\'][\'event_id\']"}},{"column":"winlog_channel", "Properties":{"Path":"$[\'winlog\'][\'channel\']"}},{"column":"event_provider", "Properties":{"Path":"$[\'event\'][\'provider\']"}},{"column":"event_code", "Properties":{"Path":"$[\'event\'][\'code\']"}},{"column":"event_kind", "Properties":{"Path":"$[\'event\'][\'kind\']"}},{"column":"event_created", "Properties":{"Path":"$[\'event\'][\'created\']"}},{"column":"ecs_version", "Properties":{"Path":"$[\'ecs\'][\'version\']"}},{"column":"winlog_user_data_SessionID", "Properties":{"Path":"$[\'winlog\'][\'user_data\'][\'SessionID\']"}},{"column":"winlog_user_data_Address", "Properties":{"Path":"$[\'winlog\'][\'user_data\'][\'Address\']"}},{"column":"winlog_user_data_User", "Properties":{"Path":"$[\'winlog\'][\'user_data\'][\'User\']"}},{"column":"winlog_user_data_xml_name", "Properties":{"Path":"$[\'winlog\'][\'user_data\'][\'xml_name\']"}},{"column":"winlog_process_pid", "Properties":{"Path":"$[\'winlog\'][\'process\'][\'pid\']"}},{"column":"winlog_process_thread", "Properties":{"Path":"$[\'winlog\'][\'process\'][\'thread\']"}},{"column":"winlog_user_domain", "Properties":{"Path":"$[\'winlog\'][\'user\'][\'domain\']"}},{"column":"winlog_user_identifier", "Properties":{"Path":"$[\'winlog\'][\'user\'][\'identifier\']"}},{"column":"winlog_user_name", "Properties":{"Path":"$[\'winlog\'][\'user\'][\'name\']"}},{"column":"winlog_user_type", "Properties":{"Path":"$[\'winlog\'][\'user\'][\'type\']"}},{"column":"host_os_version", "Properties":{"Path":"$[\'host\'][\'os\'][\'version\']"}},{"column":"host_os_family", "Properties":{"Path":"$[\'host\'][\'os\'][\'family\']"}},{"column":"host_os_platform", "Properties":{"Path":"$[\'host\'][\'os\'][\'platform\']"}},{"column":"host_os_build", "Properties":{"Path":"$[\'host\'][\'os\'][\'build\']"}},{"column":"host_os_name", "Properties":{"Path":"$[\'host\'][\'os\'][\'name\']"}},{"column":"host_os_kernel", "Properties":{"Path":"$[\'host\'][\'os\'][\'kernel\']"}},{"column":"host_os_type", "Properties":{"Path":"$[\'host\'][\'os\'][\'type\']"}}]'

//mdatpd
.create-merge table zmdatpraw (Timestamp:datetime,DeviceId:string,DeviceName:string,ActionType:string,FileName:string,FolderPath:string,SHA1:string,SHA256:string,MD5:guid,FileSize:long,ProcessVersionInfoCompanyName:string,ProcessVersionInfoProductName:string,ProcessVersionInfoProductVersion:string,ProcessVersionInfoInternalFileName:string,ProcessVersionInfoOriginalFileName:string,ProcessVersionInfoFileDescription:string,ProcessId:long,ProcessCommandLine:string,ProcessIntegrityLevel:string,ProcessTokenElevation:string,ProcessCreationTime:datetime,AccountDomain:string,AccountName:string,AccountSid:string,AccountUpn:string,AccountObjectId:string,LogonId:long,InitiatingProcessAccountDomain:string,InitiatingProcessAccountName:string,InitiatingProcessAccountSid:string,InitiatingProcessAccountUpn:string,InitiatingProcessAccountObjectId:string,InitiatingProcessLogonId:long,InitiatingProcessIntegrityLevel:string,InitiatingProcessTokenElevation:string,InitiatingProcessSHA1:string,InitiatingProcessSHA256:string,InitiatingProcessMD5:guid,InitiatingProcessFileName:string,InitiatingProcessFileSize:long,InitiatingProcessVersionInfoCompanyName:string,InitiatingProcessVersionInfoProductName:string,InitiatingProcessVersionInfoProductVersion:string,InitiatingProcessVersionInfoInternalFileName:string,InitiatingProcessVersionInfoOriginalFileName:string,InitiatingProcessVersionInfoFileDescription:string,InitiatingProcessId:long,InitiatingProcessCommandLine:string,InitiatingProcessCreationTime:datetime,InitiatingProcessFolderPath:string,InitiatingProcessParentId:long,InitiatingProcessParentFileName:string,InitiatingProcessParentCreationTime:datetime,InitiatingProcessSignerType:string,InitiatingProcessSignatureStatus:string,ReportId:long,AppGuardContainerId:string,AdditionalFields:dynamic)  with (folder = "Raw", docstring = "Raw table for mdatp")

//mdatp events csv mapping
.create table zmdatpraw ingestion csv mapping "mdatpCsvMapping" '[{"Name":"Timestamp","DataType":"","Ordinal":"0"},{"Name":"DeviceId","DataType":"","Ordinal":"1"},{"Name":"DeviceName","DataType":"","Ordinal":"2"},{"Name":"ActionType","DataType":"","Ordinal":"3"},{"Name":"FileName","DataType":"","Ordinal":"4"},{"Name":"FolderPath","DataType":"","Ordinal":"5"},{"Name":"SHA1","DataType":"","Ordinal":"6"},{"Name":"SHA256","DataType":"","Ordinal":"7"},{"Name":"MD5","DataType":"","Ordinal":"8"},{"Name":"FileSize","DataType":"","Ordinal":"9"},{"Name":"ProcessVersionInfoCompanyName","DataType":"","Ordinal":"10"},{"Name":"ProcessVersionInfoProductName","DataType":"","Ordinal":"11"},{"Name":"ProcessVersionInfoProductVersion","DataType":"","Ordinal":"12"},{"Name":"ProcessVersionInfoInternalFileName","DataType":"","Ordinal":"13"},{"Name":"ProcessVersionInfoOriginalFileName","DataType":"","Ordinal":"14"},{"Name":"ProcessVersionInfoFileDescription","DataType":"","Ordinal":"15"},{"Name":"ProcessId","DataType":"","Ordinal":"16"},{"Name":"ProcessCommandLine","DataType":"","Ordinal":"17"},{"Name":"ProcessIntegrityLevel","DataType":"","Ordinal":"18"},{"Name":"ProcessTokenElevation","DataType":"","Ordinal":"19"},{"Name":"ProcessCreationTime","DataType":"","Ordinal":"20"},{"Name":"AccountDomain","DataType":"","Ordinal":"21"},{"Name":"AccountName","DataType":"","Ordinal":"22"},{"Name":"AccountSid","DataType":"","Ordinal":"23"},{"Name":"AccountUpn","DataType":"","Ordinal":"24"},{"Name":"AccountObjectId","DataType":"","Ordinal":"25"},{"Name":"LogonId","DataType":"","Ordinal":"26"},{"Name":"InitiatingProcessAccountDomain","DataType":"","Ordinal":"27"},{"Name":"InitiatingProcessAccountName","DataType":"","Ordinal":"28"},{"Name":"InitiatingProcessAccountSid","DataType":"","Ordinal":"29"},{"Name":"InitiatingProcessAccountUpn","DataType":"","Ordinal":"30"},{"Name":"InitiatingProcessAccountObjectId","DataType":"","Ordinal":"31"},{"Name":"InitiatingProcessLogonId","DataType":"","Ordinal":"32"},{"Name":"InitiatingProcessIntegrityLevel","DataType":"","Ordinal":"33"},{"Name":"InitiatingProcessTokenElevation","DataType":"","Ordinal":"34"},{"Name":"InitiatingProcessSHA1","DataType":"","Ordinal":"35"},{"Name":"InitiatingProcessSHA256","DataType":"","Ordinal":"36"},{"Name":"InitiatingProcessMD5","DataType":"","Ordinal":"37"},{"Name":"InitiatingProcessFileName","DataType":"","Ordinal":"38"},{"Name":"InitiatingProcessFileSize","DataType":"","Ordinal":"39"},{"Name":"InitiatingProcessVersionInfoCompanyName","DataType":"","Ordinal":"40"},{"Name":"InitiatingProcessVersionInfoProductName","DataType":"","Ordinal":"41"},{"Name":"InitiatingProcessVersionInfoProductVersion","DataType":"","Ordinal":"42"},{"Name":"InitiatingProcessVersionInfoInternalFileName","DataType":"","Ordinal":"43"},{"Name":"InitiatingProcessVersionInfoOriginalFileName","DataType":"","Ordinal":"44"},{"Name":"InitiatingProcessVersionInfoFileDescription","DataType":"","Ordinal":"45"},{"Name":"InitiatingProcessId","DataType":"","Ordinal":"46"},{"Name":"InitiatingProcessCommandLine","DataType":"","Ordinal":"47"},{"Name":"InitiatingProcessCreationTime","DataType":"","Ordinal":"48"},{"Name":"InitiatingProcessFolderPath","DataType":"","Ordinal":"49"},{"Name":"InitiatingProcessParentId","DataType":"","Ordinal":"50"},{"Name":"InitiatingProcessParentFileName","DataType":"","Ordinal":"51"},{"Name":"InitiatingProcessParentCreationTime","DataType":"","Ordinal":"52"},{"Name":"InitiatingProcessSignerType","DataType":"","Ordinal":"53"},{"Name":"InitiatingProcessSignatureStatus","DataType":"","Ordinal":"54"},{"Name":"ReportId","DataType":"","Ordinal":"55"},{"Name":"AppGuardContainerId","DataType":"","Ordinal":"56"},{"Name":"AdditionalFields","DataType":"","Ordinal":"57"}]'

//suricata
.create table zsuricataraw (agent_ephemeral_id:guid,agent_hostname:string,agent_name:string,agent_id:guid,agent_type:string,agent_version:string,log_file:dynamic,log_offset:long,destination_geo:dynamic,destination_as:dynamic,destination_address:string,destination_packets:long,destination_port:long,destination_ip:string,destination_bytes:long,destination_domain:string,rule_name:string,rule_id:string,rule_category:string,source_address:string,source_packets:long,source_port:long,source_ip:string,source_bytes:long,network_packets:long,network_community_id:string,network_protocol:string,network_bytes:long,network_direction:string,network_transport:string,ecs_version:string,related_ip:dynamic,related_hosts:dynamic,host_ip:dynamic,host_hostname:string,host_os:dynamic,host_architecture:string,host_containerized:bool,host_name:string,host_mac:dynamic,host_id:string,event_original:string,event_severity:long,event_ingested:datetime,event_dataset:string,event_kind:string,event_created:datetime,event_module:string,event_start:datetime,event_category:dynamic,event_type:dynamic,fileset_name:string,message:string,url_path:string,url_original:string,url_domain:string,tags:dynamic,input_type:string,_timestamp:datetime,service_type:string,http_request:dynamic,http_response:dynamic,suricata_eve:dynamic) with (folder = "Raw", docstring = "Raw table for suricata")

//suricata json mapping
.create table zsuricataraw ingestion json mapping "suricataJsonMapping" '[{"column":"agent_ephemeral_id","path":"$[\'agent\'][\'ephemeral_id\']","datatype":"","transform":null},{"column":"agent_hostname","path":"$[\'agent\'][\'hostname\']","datatype":"","transform":null},{"column":"agent_name","path":"$[\'agent\'][\'name\']","datatype":"","transform":null},{"column":"agent_id","path":"$[\'agent\'][\'id\']","datatype":"","transform":null},{"column":"agent_type","path":"$[\'agent\'][\'type\']","datatype":"","transform":null},{"column":"agent_version","path":"$[\'agent\'][\'version\']","datatype":"","transform":null},{"column":"log_file","path":"$[\'log\'][\'file\']","datatype":"","transform":null},{"column":"log_offset","path":"$[\'log\'][\'offset\']","datatype":"","transform":null},{"column":"destination_geo","path":"$[\'destination\'][\'geo\']","datatype":"","transform":null},{"column":"destination_as","path":"$[\'destination\'][\'as\']","datatype":"","transform":null},{"column":"destination_address","path":"$[\'destination\'][\'address\']","datatype":"","transform":null},{"column":"destination_packets","path":"$[\'destination\'][\'packets\']","datatype":"","transform":null},{"column":"destination_port","path":"$[\'destination\'][\'port\']","datatype":"","transform":null},{"column":"destination_ip","path":"$[\'destination\'][\'ip\']","datatype":"","transform":null},{"column":"destination_bytes","path":"$[\'destination\'][\'bytes\']","datatype":"","transform":null},{"column":"destination_domain","path":"$[\'destination\'][\'domain\']","datatype":"","transform":null},{"column":"rule_name","path":"$[\'rule\'][\'name\']","datatype":"","transform":null},{"column":"rule_id","path":"$[\'rule\'][\'id\']","datatype":"","transform":null},{"column":"rule_category","path":"$[\'rule\'][\'category\']","datatype":"","transform":null},{"column":"source_address","path":"$[\'source\'][\'address\']","datatype":"","transform":null},{"column":"source_packets","path":"$[\'source\'][\'packets\']","datatype":"","transform":null},{"column":"source_port","path":"$[\'source\'][\'port\']","datatype":"","transform":null},{"column":"source_ip","path":"$[\'source\'][\'ip\']","datatype":"","transform":null},{"column":"source_bytes","path":"$[\'source\'][\'bytes\']","datatype":"","transform":null},{"column":"network_packets","path":"$[\'network\'][\'packets\']","datatype":"","transform":null},{"column":"network_community_id","path":"$[\'network\'][\'community_id\']","datatype":"","transform":null},{"column":"network_protocol","path":"$[\'network\'][\'protocol\']","datatype":"","transform":null},{"column":"network_bytes","path":"$[\'network\'][\'bytes\']","datatype":"","transform":null},{"column":"network_direction","path":"$[\'network\'][\'direction\']","datatype":"","transform":null},{"column":"network_transport","path":"$[\'network\'][\'transport\']","datatype":"","transform":null},{"column":"ecs_version","path":"$[\'ecs\'][\'version\']","datatype":"","transform":null},{"column":"related_ip","path":"$[\'related\'][\'ip\']","datatype":"","transform":null},{"column":"related_hosts","path":"$[\'related\'][\'hosts\']","datatype":"","transform":null},{"column":"host_ip","path":"$[\'host\'][\'ip\']","datatype":"","transform":null},{"column":"host_hostname","path":"$[\'host\'][\'hostname\']","datatype":"","transform":null},{"column":"host_os","path":"$[\'host\'][\'os\']","datatype":"","transform":null},{"column":"host_architecture","path":"$[\'host\'][\'architecture\']","datatype":"","transform":null},{"column":"host_containerized","path":"$[\'host\'][\'containerized\']","datatype":"","transform":null},{"column":"host_name","path":"$[\'host\'][\'name\']","datatype":"","transform":null},{"column":"host_mac","path":"$[\'host\'][\'mac\']","datatype":"","transform":null},{"column":"host_id","path":"$[\'host\'][\'id\']","datatype":"","transform":null},{"column":"event_original","path":"$[\'event\'][\'original\']","datatype":"","transform":null},{"column":"event_severity","path":"$[\'event\'][\'severity\']","datatype":"","transform":null},{"column":"event_ingested","path":"$[\'event\'][\'ingested\']","datatype":"","transform":null},{"column":"event_dataset","path":"$[\'event\'][\'dataset\']","datatype":"","transform":null},{"column":"event_kind","path":"$[\'event\'][\'kind\']","datatype":"","transform":null},{"column":"event_created","path":"$[\'event\'][\'created\']","datatype":"","transform":null},{"column":"event_module","path":"$[\'event\'][\'module\']","datatype":"","transform":null},{"column":"event_start","path":"$[\'event\'][\'start\']","datatype":"","transform":null},{"column":"event_category","path":"$[\'event\'][\'category\']","datatype":"","transform":null},{"column":"event_type","path":"$[\'event\'][\'type\']","datatype":"","transform":null},{"column":"fileset_name","path":"$[\'fileset\'][\'name\']","datatype":"","transform":null},{"column":"message","path":"$[\'message\']","datatype":"","transform":null},{"column":"url_path","path":"$[\'url\'][\'path\']","datatype":"","transform":null},{"column":"url_original","path":"$[\'url\'][\'original\']","datatype":"","transform":null},{"column":"url_domain","path":"$[\'url\'][\'domain\']","datatype":"","transform":null},{"column":"tags","path":"$[\'tags\']","datatype":"","transform":null},{"column":"input_type","path":"$[\'input\'][\'type\']","datatype":"","transform":null},{"column":"_timestamp","path":"$[\'@timestamp\']","datatype":"","transform":null},{"column":"service_type","path":"$[\'service\'][\'type\']","datatype":"","transform":null},{"column":"http_request","path":"$[\'http\'][\'request\']","datatype":"","transform":null},{"column":"http_response","path":"$[\'http\'][\'response\']","datatype":"","transform":null},{"column":"suricata_eve","path":"$[\'suricata\'][\'eve\']","datatype":"","transform":null}]'

//Sigma kql schema
.create table zsigmaraw (Timestamp:datetime,RuleAuthor:string,Computer:string,Channel:string,EventID:int,Level:string,RuleTitle:string,RuleFile:string,Details:dynamic) with (folder = "Raw", docstring = "Raw table for sigma")

//sigma json ingestion mapping
.create table zsigmaraw ingestion json mapping "sigmaJsonMapping" '[{"column":"Timestamp","path":"$['Timestamp']","datatype":""},{"column":"RuleAuthor","path":"$['RuleAuthor']","datatype":""},{"column":"Computer","path":"$['Computer']","datatype":""},{"column":"Channel","path":"$['Channel']","datatype":""},{"column":"EventID","path":"$['EventID']","datatype":""},{"column":"Level","path":"$['Level']","datatype":""},{"column":"RuleTitle","path":"$['RuleTitle']","datatype":""},{"column":"RuleFile","path":"$['RuleFile']","datatype":""},{"column":"Details","path":"$['Details']","datatype":""}]'

//timeline
.create table timeline (['date']:datetime,['time']:timespan,timezone:string,MACB:string,source:string,sourcetype:string,type:string,user:string,host:string,short:string,['desc']:string,version:long,filename:string,inode:string,notes:string,format:string,extra:string)
//timeline csv mapping
.create table timeline ingestion csv mapping "timelineCsvMapping" '[{"Name":"date","DataType":"","Ordinal":"0","ConstValue":null},{"Name":"time","DataType":"","Ordinal":"1","ConstValue":null},{"Name":"timezone","DataType":"","Ordinal":"2","ConstValue":null},{"Name":"MACB","DataType":"","Ordinal":"3","ConstValue":null},{"Name":"source","DataType":"","Ordinal":"4","ConstValue":null},{"Name":"sourcetype","DataType":"","Ordinal":"5","ConstValue":null},{"Name":"type","DataType":"","Ordinal":"6","ConstValue":null},{"Name":"user","DataType":"","Ordinal":"7","ConstValue":null},{"Name":"host","DataType":"","Ordinal":"8","ConstValue":null},{"Name":"short","DataType":"","Ordinal":"9","ConstValue":null},{"Name":"desc","DataType":"","Ordinal":"10","ConstValue":null},{"Name":"version","DataType":"","Ordinal":"11","ConstValue":null},{"Name":"filename","DataType":"","Ordinal":"12","ConstValue":null},{"Name":"inode","DataType":"","Ordinal":"13","ConstValue":null},{"Name":"notes","DataType":"","Ordinal":"14","ConstValue":null},{"Name":"format","DataType":"","Ordinal":"15","ConstValue":null},{"Name":"extra","DataType":"","Ordinal":"16","ConstValue":null}]'

//zeek
.create-merge table zzeekraw (agent_type:string,agent_ephemeral_id:guid,agent_version:string,agent_name:string,agent_hostname:string,agent_id:guid,log_file_path:string,log_offset:long,destination_address:string,destination_bytes:long,destination_as_number:long,destination_as_organization:dynamic,destination_port:long,destination_ip:string,destination_packets:long,destination_geo_location:dynamic,destination_geo_country_name:string,destination_geo_region_name:string,destination_geo_region_iso_code:string,destination_geo_city_name:string,destination_geo_country_iso_code:string,destination_geo_continent_name:string,zeek_connection_history:string,zeek_connection_state:string,zeek_connection_state_message:string,zeek_connection_local_orig:bool,zeek_connection_local_resp:bool,zeek_connection_missed_bytes:long,zeek_session_id:string,zeek_smb_mapping_share_type:string,zeek_smb_mapping_path:string,zeek_http_trans_depth:long,zeek_http_orig_fuids:dynamic,zeek_http_tags:dynamic,zeek_dce_rpc_named_pipe:string,zeek_dce_rpc_rtt:real,zeek_dce_rpc_operation:string,zeek_dce_rpc_endpoint:string,zeek_ssl_established:bool,zeek_ssl_server:dynamic,zeek_ssl_validation:dynamic,zeek_ssl_resumed:bool,zeek_ssl_cipher:string,zeek_ssl_cert_chain_fps:dynamic,zeek_ssl_version:string,zeek_ssl_curve:string,zeek_ssl_client_cert_chain_fps:dynamic,zeek_ssl_sni_matches_cert:bool,zeek_ssl_ssl_history:string,zeek_ssl_next_protocol:string,zeek_dns_rejected:bool,zeek_dns_RA:bool,zeek_dns_qclass:long,zeek_dns_qtype:long,zeek_dns_TTLs:dynamic,zeek_dns_qtype_name:string,zeek_dns_rcode_name:string,zeek_dns_AA:bool,zeek_dns_query:string,zeek_dns_rtt:real,zeek_dns_trans_id:string,zeek_dns_qclass_name:string,zeek_dns_rcode:long,zeek_dns_RD:bool,zeek_dns_answers:dynamic,zeek_dns_TC:bool,source_ip:string,source_geo_location:dynamic,source_geo_country_iso_code:string,source_geo_continent_name:string,source_geo_country_name:string,source_geo_city_name:string,source_geo_region_name:string,source_geo_region_iso_code:string,source_as_number:long,source_as_organization:dynamic,source_bytes:long,source_port:long,source_packets:long,source_address:string,fileset_name:string,tags:dynamic,network_community_id:string,network_bytes:long,network_packets:long,network_direction:string,network_transport:string,network_protocol:string,input_type:string,_timestamp:datetime,ecs_version:string,related_ip:dynamic,service_type:string,host_id:string,host_architecture:string,host_name:string,host_hostname:string,host_containerized:bool,host_mac:dynamic,host_ip:dynamic,host_os_kernel:string,host_os_family:string,host_os_version:string,host_os_type:string,host_os_codename:string,host_os_name:string,host_os_platform:string,event_type:dynamic,event_dataset:string,event_created:datetime,event_outcome:string,event_kind:string,event_category:dynamic,event_ingested:datetime,event_id:string,event_module:string,event_duration_0:long,event_duration_1:real,event_original:string,event_action:string,dns_response_code:string,dns_question_subdomain:string,dns_question_class:string,dns_question_type:string,dns_question_name:string,dns_question_registered_domain:string,dns_question_top_level_domain:string,dns_answers:dynamic,dns_id:string,dns_header_flags_0:dynamic,dns_header_flags_1:string,dns_type:string,dns_resolved_ip:dynamic,url_original:string,url_port:long,url_domain:string,http_request_method:string,http_request_body:dynamic,http_response_body:dynamic,user_agent_device_name:string,user_agent_name:string,user_agent_original:string,user_agent_version:string,user_agent_os_name:string,user_agent_os_version:string,user_agent_os_full:string,server_address:string,client_address:string,tls_curve:string,tls_established:bool,tls_server_ja3s:string,tls_client_ja3:string,tls_version_protocol:string,tls_resumed:bool,tls_version:string,tls_cipher:string) with (folder = "Raw", docstring = "Raw table for zeek")


.create-merge table zzeekraw ingestion csv mapping "zeekJsonMapping" '[{"column":"agent_type","path":"$['agent']['type']","datatype":""},{"column":"agent_ephemeral_id","path":"$['agent']['ephemeral_id']","datatype":""},{"column":"agent_version","path":"$['agent']['version']","datatype":""},{"column":"agent_name","path":"$['agent']['name']","datatype":""},{"column":"agent_hostname","path":"$['agent']['hostname']","datatype":""},{"column":"agent_id","path":"$['agent']['id']","datatype":""},{"column":"log_file_path","path":"$['log']['file']['path']","datatype":""},{"column":"log_offset","path":"$['log']['offset']","datatype":""},{"column":"destination_address","path":"$['destination']['address']","datatype":""},{"column":"destination_bytes","path":"$['destination']['bytes']","datatype":""},{"column":"destination_as_number","path":"$['destination']['as']['number']","datatype":""},{"column":"destination_as_organization","path":"$['destination']['as']['organization']","datatype":""},{"column":"destination_port","path":"$['destination']['port']","datatype":""},{"column":"destination_ip","path":"$['destination']['ip']","datatype":""},{"column":"destination_packets","path":"$['destination']['packets']","datatype":""},{"column":"destination_geo_location","path":"$['destination']['geo']['location']","datatype":""},{"column":"destination_geo_country_name","path":"$['destination']['geo']['country_name']","datatype":""},{"column":"destination_geo_region_name","path":"$['destination']['geo']['region_name']","datatype":""},{"column":"destination_geo_region_iso_code","path":"$['destination']['geo']['region_iso_code']","datatype":""},{"column":"destination_geo_city_name","path":"$['destination']['geo']['city_name']","datatype":""},{"column":"destination_geo_country_iso_code","path":"$['destination']['geo']['country_iso_code']","datatype":""},{"column":"destination_geo_continent_name","path":"$['destination']['geo']['continent_name']","datatype":""},{"column":"zeek_connection_history","path":"$['zeek']['connection']['history']","datatype":""},{"column":"zeek_connection_state","path":"$['zeek']['connection']['state']","datatype":""},{"column":"zeek_connection_state_message","path":"$['zeek']['connection']['state_message']","datatype":""},{"column":"zeek_connection_local_orig","path":"$['zeek']['connection']['local_orig']","datatype":""},{"column":"zeek_connection_local_resp","path":"$['zeek']['connection']['local_resp']","datatype":""},{"column":"zeek_connection_missed_bytes","path":"$['zeek']['connection']['missed_bytes']","datatype":""},{"column":"zeek_session_id","path":"$['zeek']['session_id']","datatype":""},{"column":"zeek_smb_mapping_share_type","path":"$['zeek']['smb_mapping']['share_type']","datatype":""},{"column":"zeek_smb_mapping_path","path":"$['zeek']['smb_mapping']['path']","datatype":""},{"column":"zeek_http_trans_depth","path":"$['zeek']['http']['trans_depth']","datatype":""},{"column":"zeek_http_orig_fuids","path":"$['zeek']['http']['orig_fuids']","datatype":""},{"column":"zeek_http_tags","path":"$['zeek']['http']['tags']","datatype":""},{"column":"zeek_dce_rpc_named_pipe","path":"$['zeek']['dce_rpc']['named_pipe']","datatype":""},{"column":"zeek_dce_rpc_rtt","path":"$['zeek']['dce_rpc']['rtt']","datatype":""},{"column":"zeek_dce_rpc_operation","path":"$['zeek']['dce_rpc']['operation']","datatype":""},{"column":"zeek_dce_rpc_endpoint","path":"$['zeek']['dce_rpc']['endpoint']","datatype":""},{"column":"zeek_ssl_established","path":"$['zeek']['ssl']['established']","datatype":""},{"column":"zeek_ssl_server","path":"$['zeek']['ssl']['server']","datatype":""},{"column":"zeek_ssl_validation","path":"$['zeek']['ssl']['validation']","datatype":""},{"column":"zeek_ssl_resumed","path":"$['zeek']['ssl']['resumed']","datatype":""},{"column":"zeek_ssl_cipher","path":"$['zeek']['ssl']['cipher']","datatype":""},{"column":"zeek_ssl_cert_chain_fps","path":"$['zeek']['ssl']['cert_chain_fps']","datatype":""},{"column":"zeek_ssl_version","path":"$['zeek']['ssl']['version']","datatype":""},{"column":"zeek_ssl_curve","path":"$['zeek']['ssl']['curve']","datatype":""},{"column":"zeek_ssl_client_cert_chain_fps","path":"$['zeek']['ssl']['client_cert_chain_fps']","datatype":""},{"column":"zeek_ssl_sni_matches_cert","path":"$['zeek']['ssl']['sni_matches_cert']","datatype":""},{"column":"zeek_ssl_ssl_history","path":"$['zeek']['ssl']['ssl_history']","datatype":""},{"column":"zeek_ssl_next_protocol","path":"$['zeek']['ssl']['next_protocol']","datatype":""},{"column":"zeek_dns_rejected","path":"$['zeek']['dns']['rejected']","datatype":""},{"column":"zeek_dns_RA","path":"$['zeek']['dns']['RA']","datatype":""},{"column":"zeek_dns_qclass","path":"$['zeek']['dns']['qclass']","datatype":""},{"column":"zeek_dns_qtype","path":"$['zeek']['dns']['qtype']","datatype":""},{"column":"zeek_dns_TTLs","path":"$['zeek']['dns']['TTLs']","datatype":""},{"column":"zeek_dns_qtype_name","path":"$['zeek']['dns']['qtype_name']","datatype":""},{"column":"zeek_dns_rcode_name","path":"$['zeek']['dns']['rcode_name']","datatype":""},{"column":"zeek_dns_AA","path":"$['zeek']['dns']['AA']","datatype":""},{"column":"zeek_dns_query","path":"$['zeek']['dns']['query']","datatype":""},{"column":"zeek_dns_rtt","path":"$['zeek']['dns']['rtt']","datatype":""},{"column":"zeek_dns_trans_id","path":"$['zeek']['dns']['trans_id']","datatype":""},{"column":"zeek_dns_qclass_name","path":"$['zeek']['dns']['qclass_name']","datatype":""},{"column":"zeek_dns_rcode","path":"$['zeek']['dns']['rcode']","datatype":""},{"column":"zeek_dns_RD","path":"$['zeek']['dns']['RD']","datatype":""},{"column":"zeek_dns_answers","path":"$['zeek']['dns']['answers']","datatype":""},{"column":"zeek_dns_TC","path":"$['zeek']['dns']['TC']","datatype":""},{"column":"source_ip","path":"$['source']['ip']","datatype":""},{"column":"source_geo_location","path":"$['source']['geo']['location']","datatype":""},{"column":"source_geo_country_iso_code","path":"$['source']['geo']['country_iso_code']","datatype":""},{"column":"source_geo_continent_name","path":"$['source']['geo']['continent_name']","datatype":""},{"column":"source_geo_country_name","path":"$['source']['geo']['country_name']","datatype":""},{"column":"source_geo_city_name","path":"$['source']['geo']['city_name']","datatype":""},{"column":"source_geo_region_name","path":"$['source']['geo']['region_name']","datatype":""},{"column":"source_geo_region_iso_code","path":"$['source']['geo']['region_iso_code']","datatype":""},{"column":"source_as_number","path":"$['source']['as']['number']","datatype":""},{"column":"source_as_organization","path":"$['source']['as']['organization']","datatype":""},{"column":"source_bytes","path":"$['source']['bytes']","datatype":""},{"column":"source_port","path":"$['source']['port']","datatype":""},{"column":"source_packets","path":"$['source']['packets']","datatype":""},{"column":"source_address","path":"$['source']['address']","datatype":""},{"column":"fileset_name","path":"$['fileset']['name']","datatype":""},{"column":"tags","path":"$['tags']","datatype":""},{"column":"network_community_id","path":"$['network']['community_id']","datatype":""},{"column":"network_bytes","path":"$['network']['bytes']","datatype":""},{"column":"network_packets","path":"$['network']['packets']","datatype":""},{"column":"network_direction","path":"$['network']['direction']","datatype":""},{"column":"network_transport","path":"$['network']['transport']","datatype":""},{"column":"network_protocol","path":"$['network']['protocol']","datatype":""},{"column":"input_type","path":"$['input']['type']","datatype":""},{"column":"_timestamp","path":"$['@timestamp']","datatype":""},{"column":"ecs_version","path":"$['ecs']['version']","datatype":""},{"column":"related_ip","path":"$['related']['ip']","datatype":""},{"column":"service_type","path":"$['service']['type']","datatype":""},{"column":"host_id","path":"$['host']['id']","datatype":""},{"column":"host_architecture","path":"$['host']['architecture']","datatype":""},{"column":"host_name","path":"$['host']['name']","datatype":""},{"column":"host_hostname","path":"$['host']['hostname']","datatype":""},{"column":"host_containerized","path":"$['host']['containerized']","datatype":""},{"column":"host_mac","path":"$['host']['mac']","datatype":""},{"column":"host_ip","path":"$['host']['ip']","datatype":""},{"column":"host_os_kernel","path":"$['host']['os']['kernel']","datatype":""},{"column":"host_os_family","path":"$['host']['os']['family']","datatype":""},{"column":"host_os_version","path":"$['host']['os']['version']","datatype":""},{"column":"host_os_type","path":"$['host']['os']['type']","datatype":""},{"column":"host_os_codename","path":"$['host']['os']['codename']","datatype":""},{"column":"host_os_name","path":"$['host']['os']['name']","datatype":""},{"column":"host_os_platform","path":"$['host']['os']['platform']","datatype":""},{"column":"event_type","path":"$['event']['type']","datatype":""},{"column":"event_dataset","path":"$['event']['dataset']","datatype":""},{"column":"event_created","path":"$['event']['created']","datatype":""},{"column":"event_outcome","path":"$['event']['outcome']","datatype":""},{"column":"event_kind","path":"$['event']['kind']","datatype":""},{"column":"event_category","path":"$['event']['category']","datatype":""},{"column":"event_ingested","path":"$['event']['ingested']","datatype":""},{"column":"event_id","path":"$['event']['id']","datatype":""},{"column":"event_module","path":"$['event']['module']","datatype":""},{"column":"event_duration_0","path":"$['event']['duration']['0']","datatype":""},{"column":"event_duration_1","path":"$['event']['duration']['1']","datatype":""},{"column":"event_original","path":"$['event']['original']","datatype":""},{"column":"event_action","path":"$['event']['action']","datatype":""},{"column":"dns_response_code","path":"$['dns']['response_code']","datatype":""},{"column":"dns_question_subdomain","path":"$['dns']['question']['subdomain']","datatype":""},{"column":"dns_question_class","path":"$['dns']['question']['class']","datatype":""},{"column":"dns_question_type","path":"$['dns']['question']['type']","datatype":""},{"column":"dns_question_name","path":"$['dns']['question']['name']","datatype":""},{"column":"dns_question_registered_domain","path":"$['dns']['question']['registered_domain']","datatype":""},{"column":"dns_question_top_level_domain","path":"$['dns']['question']['top_level_domain']","datatype":""},{"column":"dns_answers","path":"$['dns']['answers']","datatype":""},{"column":"dns_id","path":"$['dns']['id']","datatype":""},{"column":"dns_header_flags_0","path":"$['dns']['header_flags']['0']","datatype":""},{"column":"dns_header_flags_1","path":"$['dns']['header_flags']['1']","datatype":""},{"column":"dns_type","path":"$['dns']['type']","datatype":""},{"column":"dns_resolved_ip","path":"$['dns']['resolved_ip']","datatype":""},{"column":"url_original","path":"$['url']['original']","datatype":""},{"column":"url_port","path":"$['url']['port']","datatype":""},{"column":"url_domain","path":"$['url']['domain']","datatype":""},{"column":"http_request_method","path":"$['http']['request']['method']","datatype":""},{"column":"http_request_body","path":"$['http']['request']['body']","datatype":""},{"column":"http_response_body","path":"$['http']['response']['body']","datatype":""},{"column":"user_agent_device_name","path":"$['user_agent']['device']['name']","datatype":""},{"column":"user_agent_name","path":"$['user_agent']['name']","datatype":""},{"column":"user_agent_original","path":"$['user_agent']['original']","datatype":""},{"column":"user_agent_version","path":"$['user_agent']['version']","datatype":""},{"column":"user_agent_os_name","path":"$['user_agent']['os']['name']","datatype":""},{"column":"user_agent_os_version","path":"$['user_agent']['os']['version']","datatype":""},{"column":"user_agent_os_full","path":"$['user_agent']['os']['full']","datatype":""},{"column":"server_address","path":"$['server']['address']","datatype":""},{"column":"client_address","path":"$['client']['address']","datatype":""},{"column":"tls_curve","path":"$['tls']['curve']","datatype":""},{"column":"tls_established","path":"$['tls']['established']","datatype":""},{"column":"tls_server_ja3s","path":"$['tls']['server']['ja3s']","datatype":""},{"column":"tls_client_ja3","path":"$['tls']['client']['ja3']","datatype":""},{"column":"tls_version_protocol","path":"$['tls']['version_protocol']","datatype":""},{"column":"tls_resumed","path":"$['tls']['resumed']","datatype":""},{"column":"tls_version","path":"$['tls']['version']","datatype":""},{"column":"tls_cipher","path":"$['tls']['cipher']","datatype":""}]'
